---
title: "TimRayburn.CustomFunctoids - Logical NOT"
layout: post
---
<p>The first in a series of posts on my functoids library.&nbsp; <a href="http://www.timrayburn.net/2006/09/29/TimRayburnCustomFunctoids.aspx">More information can be found here.</a>&nbsp; While I realize that Logical NOT has been added to the base set of functoids in BizTalk 2006, this class will still be useful for those who want to take the code and compile it under Visual Studio 2003 and use it with BizTalk 2004.&nbsp; Nothing will be used in this or future functoids which does not compile in both versions.</p> <p><a href="http://www.timrayburn.net/content/binary/WindowsLiveWriter/TimRayburn.CustomFunctoidsLogicalNOT_14E4D/LogicalNotSolution1.png" atomicselection="true"><img style="border-top-width: 0px; border-left-width: 0px; border-bottom-width: 0px; border-right-width: 0px" height="287" src="http://www.timrayburn.net/content/binary/WindowsLiveWriter/TimRayburn.CustomFunctoidsLogicalNOT_14E4D/LogicalNotSolution_thumb1.png" width="338" align="right" border="0"></a> Alright, time for the first functoid.&nbsp; This first time I will provide a step by step detail of how to create the project and the related references, etc.&nbsp; In future, this will be skipped for brevity.&nbsp; Most of this same information can be found by going to <strong>C:\Program Files\Microsoft BizTalk Server 2006\SDK\Samples\XmlTools\CustomFunctoid</strong> and examining the sample project there which shows how to create custom functoids.</p> <p>To that end, we will need to setup a project for all of these functoids.&nbsp; Opening Visual Studio 2005, we create a C# project (Sorry <a href="http://www.addressof.com">Cory</a>) and then create a strong name adjust the AssemblyInfo.cs to use our strong name, because like all BizTalk assemblies this will have to be in the GAC.&nbsp; Then we need to add a reference to Microsoft.BizTalk.BaseFunctoids.dll, this assembly holds the base libraries off of which we can build functoids and can be found at <strong>c:\Program Files\Microsoft BizTalk Server 2006\Developer Tools</strong> on most boxes.&nbsp; When you've reached this point your Solution Explorer should look like the one to the right.</p> <p>Now that the project is created, we need to setup the class.&nbsp; We'll rename Class1.cs as LogicalNotFunctoid.cs.&nbsp; Likewise we will rename the class within the file as LogicalNotFunctoid.&nbsp; All functoids derive from Microsoft.BizTalk.BaseFunctoids.BaseFunctoid and ours will be no exception.&nbsp; We'll add a default constructor which overloads the same in our base class and your code should now look like this:</p><!--{\rtf1\ansi\ansicpg\lang1024\noproof1252\uc1 \deff0{\fonttbl{\f0\fnil\fcharset0\fprq1 Consolas;}}{\colortbl;\red0\green0\blue0;\red0\green0\blue255;\red0\green255\blue255;\red0\green255\blue0??;\red255\green0\blue255;\red255\green0\blue0;\red255\green255\blue0;\red255\green255\blue255;??\red0\green0\blue128;\red0\green128\blue128;\red0\green128\blue0;??\red128\green0\blue128;\red128\green0\blue0;\red128\green128\blue0;\red128\green128\blue128;??\red192\green192\blue192;}??\fs28 \cf2 using\cf0System;\par ??\cf2 using\cf0System.Collections.Generic;\par ??\cf2 using\cf0System.Text;\par ??\cf2 using\cf0Microsoft.BizTalk.BaseFunctoids;\par ??\par ??\cf2 namespace\cf0TimRayburn.CustomFunctoids\par ??\{\par ??\cf2 public\cf0\cf2 class\cf0\cf10 LogicalNotFunctoid\cf0: \cf10 BaseFunctoid\par ??\cf0 \{\par ??\cf2 public\cf0LogicalNotFunctoid() : \cf2 base\cf0 ()\par ??\{\par ??\par ??\}\par ??\}\par ??\}\par ??}--> <div style="font-size: 10pt; background: white; color: black; font-family: consolas, courier"><pre style="margin: 0px"><span style="color: #2b91af">&nbsp;&nbsp;&nbsp;&nbsp;1</span>&nbsp;<span style="color: blue">using</span> System;</pre><pre style="margin: 0px"><span style="color: #2b91af">&nbsp;&nbsp;&nbsp;&nbsp;2</span>&nbsp;<span style="color: blue">using</span> System.Collections.Generic;</pre><pre style="margin: 0px"><span style="color: #2b91af">&nbsp;&nbsp;&nbsp;&nbsp;3</span>&nbsp;<span style="color: blue">using</span> System.Text;</pre><pre style="margin: 0px"><span style="color: #2b91af">&nbsp;&nbsp;&nbsp;&nbsp;4</span>&nbsp;<span style="color: blue">using</span> Microsoft.BizTalk.BaseFunctoids;</pre><pre style="margin: 0px"><span style="color: #2b91af">&nbsp;&nbsp;&nbsp;&nbsp;5</span>&nbsp;</pre><pre style="margin: 0px"><span style="color: #2b91af">&nbsp;&nbsp;&nbsp;&nbsp;6</span>&nbsp;<span style="color: blue">namespace</span> TimRayburn.CustomFunctoids</pre><pre style="margin: 0px"><span style="color: #2b91af">&nbsp;&nbsp;&nbsp;&nbsp;7</span>&nbsp;{</pre><pre style="margin: 0px"><span style="color: #2b91af">&nbsp;&nbsp;&nbsp;&nbsp;8</span>&nbsp;&nbsp;&nbsp;&nbsp; <span style="color: blue">public</span> <span style="color: blue">class</span> <span style="color: teal">LogicalNotFunctoid</span> : <span style="color: teal">BaseFunctoid</span></pre><pre style="margin: 0px"><span style="color: #2b91af">&nbsp;&nbsp;&nbsp;&nbsp;9</span>&nbsp;&nbsp;&nbsp;&nbsp; {</pre><pre style="margin: 0px"><span style="color: #2b91af">&nbsp;&nbsp;&nbsp;10</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp; <span style="color: blue">public</span> LogicalNotFunctoid() : <span style="color: blue">base</span>()</pre><pre style="margin: 0px"><span style="color: #2b91af">&nbsp;&nbsp;&nbsp;11</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp; {</pre><pre style="margin: 0px"><span style="color: #2b91af">&nbsp;&nbsp;&nbsp;12</span>&nbsp;</pre><pre style="margin: 0px"><span style="color: #2b91af">&nbsp;&nbsp;&nbsp;13</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp; }</pre><pre style="margin: 0px"><span style="color: #2b91af">&nbsp;&nbsp;&nbsp;14</span>&nbsp;&nbsp;&nbsp;&nbsp; }</pre><pre style="margin: 0px"><span style="color: #2b91af">&nbsp;&nbsp;&nbsp;15</span>&nbsp;}</pre><p>Next we need to add the necessary code to assign the functoid an ID, and to set the resource file where information such as the name and other information will come from.&nbsp; Most of this is simple copy-paste from the example in the SDK folder.&nbsp; We will have also added a CustomFunctoidsResources.resx to the solution to hold all these resources.&nbsp; I will not detail the creation of the resource file here, if you'd like to learn about this download the source it is fairly self-evident.&nbsp; Once you've gotten the basic constructor down it should look something like this:</p><!--{\rtf1\ansi\ansicpg\lang1024\noproof1252\uc1 \deff0{\fonttbl{\f0\fnil\fcharset0\fprq1 Consolas;}}{\colortbl;\red0\green0\blue0;\red0\green0\blue255;\red0\green255\blue255;\red0\green255\blue0??;\red255\green0\blue255;\red255\green0\blue0;\red255\green255\blue0;\red255\green255\blue255;??\red0\green0\blue128;\red0\green128\blue128;\red0\green128\blue0;??\red128\green0\blue128;\red128\green0\blue0;\red128\green128\blue0;\red128\green128\blue128;??\red192\green192\blue192;}??\fs28 \cf2 public\cf0LogicalNotFunctoid() : \cf2 base\cf0 ()\par ??\{\par ??\cf11 // Assign a "unique" id to this functiod.\par ??\cf0 \cf2 this\cf0 .ID = 24601;\par ??\par ??\cf11 // Setup the resource assembly to use.\par ??\cf0 SetupResourceAssembly(\par ??\cf13 "TimRayburn.CustomFunctoids.CustomFunctoidsResources"\cf0 , \par ??Assembly.GetExecutingAssembly());\par ??\par ??SetName(\cf13 "IDS_LOGGICALNOTFUNCTOID_NAME"\cf0 );\par ??SetTooltip(\cf13 "IDS_LOGGICALNOTFUNCTOID_TOOLTIP"\cf0 );\par ??SetDescription(\cf13 "IDS_LOGGICALNOTFUNCTOID_DESCRIPTION"\cf0 );\par ??SetBitmap(\cf13 "IDB_LOGGICALNOTFUNCTOID_BITMAP"\cf0 );\par ??\par ??\cf2 this\cf0 .SetMinParams(1);\par ??\cf2 this\cf0 .SetMaxParams(1);\par ??\}\par ??}--><div style="font-size: 10pt; background: white; color: black; font-family: consolas, courier"><pre style="margin: 0px"><span style="color: #2b91af">&nbsp;&nbsp;&nbsp;10</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp; <span style="color: blue">public</span> LogicalNotFunctoid() : <span style="color: blue">base</span>()</pre><pre style="margin: 0px"><span style="color: #2b91af">&nbsp;&nbsp;&nbsp;11</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp; {</pre><pre style="margin: 0px"><span style="color: #2b91af">&nbsp;&nbsp;&nbsp;12</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; &nbsp; <span style="color: green">// Assign a "unique" id to this functoid.</span></pre><pre style="margin: 0px"><span style="color: #2b91af">&nbsp;&nbsp;&nbsp;13</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; &nbsp; <span style="color: blue">this</span>.ID = 24601;</pre><pre style="margin: 0px"><span style="color: #2b91af">&nbsp;&nbsp;&nbsp;14</span>&nbsp;</pre><pre style="margin: 0px"><span style="color: #2b91af">&nbsp;&nbsp;&nbsp;15</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; &nbsp; <span style="color: green">// Setup the resource assembly to use.</span></pre><pre style="margin: 0px"><span style="color: #2b91af">&nbsp;&nbsp;&nbsp;16</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; &nbsp; SetupResourceAssembly(</pre><pre style="margin: 0px"><span style="color: #2b91af">&nbsp;&nbsp;&nbsp;17</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;<span style="color: maroon">"TimRayburn.CustomFunctoids.CustomFunctoidsResources"</span>, </pre><pre style="margin: 0px"><span style="color: #2b91af">&nbsp;&nbsp;&nbsp;18</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;Assembly.GetExecutingAssembly());</pre><pre style="margin: 0px"><span style="color: #2b91af">&nbsp;&nbsp;&nbsp;19</span>&nbsp;</pre><pre style="margin: 0px"><span style="color: #2b91af">&nbsp;&nbsp;&nbsp;20</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; &nbsp; SetName(<span style="color: maroon">"IDS_LOGGICALNOTFUNCTOID_NAME"</span>);</pre><pre style="margin: 0px"><span style="color: #2b91af">&nbsp;&nbsp;&nbsp;21</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; &nbsp; SetTooltip(<span style="color: maroon">"IDS_LOGGICALNOTFUNCTOID_TOOLTIP"</span>);</pre><pre style="margin: 0px"><span style="color: #2b91af">&nbsp;&nbsp;&nbsp;22</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; &nbsp; SetDescription(<span style="color: maroon">"IDS_LOGGICALNOTFUNCTOID_DESCRIPTION"</span>);</pre><pre style="margin: 0px"><span style="color: #2b91af">&nbsp;&nbsp;&nbsp;23</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; &nbsp; SetBitmap(<span style="color: maroon">"IDB_LOGGICALNOTFUNCTOID_BITMAP"</span>);</pre><pre style="margin: 0px"><span style="color: #2b91af">&nbsp;&nbsp;&nbsp;24</span>&nbsp;</pre><pre style="margin: 0px"><span style="color: #2b91af">&nbsp;&nbsp;&nbsp;25</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; &nbsp; <span style="color: blue">this</span>.SetMinParams(1);</pre><pre style="margin: 0px"><span style="color: #2b91af">&nbsp;&nbsp;&nbsp;26</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; &nbsp; <span style="color: blue">this</span>.SetMaxParams(1);</pre><pre style="margin: 0px"><span style="color: #2b91af">&nbsp;&nbsp;&nbsp;27</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp; }</pre></div></div><p>Now we need to tell the class how we expect this functoid to be called.&nbsp; It will need to be part of the Logical group, it should take a minimum of 1 parameter and a maximum of 1 parameter and it should take connections from anything that is not a Record (as Records contain no values).&nbsp; Add those lines of code and now we look like:</p><!--{\rtf1\ansi\ansicpg\lang1024\noproof1252\uc1 \deff0{\fonttbl{\f0\fnil\fcharset0\fprq1 Consolas;}}{\colortbl;\red0\green0\blue0;\red0\green0\blue255;\red0\green255\blue255;\red0\green255\blue0??;\red255\green0\blue255;\red255\green0\blue0;\red255\green255\blue0;\red255\green255\blue255;??\red0\green0\blue128;\red0\green128\blue128;\red0\green128\blue0;??\red128\green0\blue128;\red128\green0\blue0;\red128\green128\blue0;\red128\green128\blue128;??\red192\green192\blue192;}??\fs28 \cf2 public\cf0LogicalNotFunctoid() : \cf2 base\cf0 ()\par ??\{\par ??\cf11 // Assign a "unique" id to this functiod.\par ??\cf0 \cf2 this\cf0 .ID = 24601;\par ??\par ??\cf11 // Setup the resource assembly to use.\par ??\cf0 SetupResourceAssembly(\par ??\cf13 "TimRayburn.CustomFunctoids.CustomFunctoidsResources"\cf0 , \par ??Assembly.GetExecutingAssembly());\par ??\par ??SetName(\cf13 "IDS_LOGGICALNOTFUNCTOID_NAME"\cf0 );\par ??SetTooltip(\cf13 "IDS_LOGGICALNOTFUNCTOID_TOOLTIP"\cf0 );\par ??SetDescription(\cf13 "IDS_LOGGICALNOTFUNCTOID_DESCRIPTION"\cf0 );\par ??SetBitmap(\cf13 "IDB_LOGGICALNOTFUNCTOID_BITMAP"\cf0 );\par ??\par ??\cf2 this\cf0 .SetMinParams(1);\par ??\cf2 this\cf0 .SetMaxParams(1);\par ??\par ??\cf11 //set the function name that needs to be \par ??\cf0 \cf11 //called when this Functoid is invoked. This means that\par ??\cf0 \cf11 //this Functoid assembly need to be present in GAC \par ??\cf0 \cf11 //for its availability during Test..Map and Runtime.\par ??\cf0 SetExternalFunctionName(\cf2 this\cf0 .GetType().Assembly.FullName, \par ??\cf2 this\cf0 .GetType().FullName, \cf13 "LogicalNot"\cf0 );\par ??\par ??\cf2 this\cf0 .Category = \cf10 FunctoidCategory\cf0 .Logical;\par ??\cf2 this\cf0 .OutputConnectionType = \cf10 ConnectionType\cf0 .AllExceptRecord;\par ??\par ??AddInputConnectionType(\cf10 ConnectionType\cf0 .AllExceptRecord);\par ??\}\par ??}--><div style="font-size: 10pt; background: white; color: black; font-family: consolas, courier"><pre style="margin: 0px"><span style="color: #2b91af">&nbsp;&nbsp;&nbsp;10</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp; <span style="color: blue">public</span> LogicalNotFunctoid() : <span style="color: blue">base</span>()</pre><pre style="margin: 0px"><span style="color: #2b91af">&nbsp;&nbsp;&nbsp;11</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp; {</pre><pre style="margin: 0px"><span style="color: #2b91af">&nbsp;&nbsp;&nbsp;12</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; &nbsp; <span style="color: green">// Assign a "unique" id to this functoid.</span></pre><pre style="margin: 0px"><span style="color: #2b91af">&nbsp;&nbsp;&nbsp;13</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; &nbsp; <span style="color: blue">this</span>.ID = 24601;</pre><pre style="margin: 0px"><span style="color: #2b91af">&nbsp;&nbsp;&nbsp;14</span>&nbsp;</pre><pre style="margin: 0px"><span style="color: #2b91af">&nbsp;&nbsp;&nbsp;15</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; &nbsp; <span style="color: green">// Setup the resource assembly to use.</span></pre><pre style="margin: 0px"><span style="color: #2b91af">&nbsp;&nbsp;&nbsp;16</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; &nbsp; SetupResourceAssembly(</pre><pre style="margin: 0px"><span style="color: #2b91af">&nbsp;&nbsp;&nbsp;17</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;<span style="color: maroon">"TimRayburn.CustomFunctoids.CustomFunctoidsResources"</span>, </pre><pre style="margin: 0px"><span style="color: #2b91af">&nbsp;&nbsp;&nbsp;18</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;Assembly.GetExecutingAssembly());</pre><pre style="margin: 0px"><span style="color: #2b91af">&nbsp;&nbsp;&nbsp;19</span>&nbsp;</pre><pre style="margin: 0px"><span style="color: #2b91af">&nbsp;&nbsp;&nbsp;20</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; &nbsp; SetName(<span style="color: maroon">"IDS_LOGGICALNOTFUNCTOID_NAME"</span>);</pre><pre style="margin: 0px"><span style="color: #2b91af">&nbsp;&nbsp;&nbsp;21</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; &nbsp; SetTooltip(<span style="color: maroon">"IDS_LOGGICALNOTFUNCTOID_TOOLTIP"</span>);</pre><pre style="margin: 0px"><span style="color: #2b91af">&nbsp;&nbsp;&nbsp;22</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; &nbsp; SetDescription(<span style="color: maroon">"IDS_LOGGICALNOTFUNCTOID_DESCRIPTION"</span>);</pre><pre style="margin: 0px"><span style="color: #2b91af">&nbsp;&nbsp;&nbsp;23</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; &nbsp; SetBitmap(<span style="color: maroon">"IDB_LOGGICALNOTFUNCTOID_BITMAP"</span>);</pre><pre style="margin: 0px"><span style="color: #2b91af">&nbsp;&nbsp;&nbsp;24</span>&nbsp;</pre><pre style="margin: 0px"><span style="color: #2b91af">&nbsp;&nbsp;&nbsp;25</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; &nbsp; <span style="color: blue">this</span>.SetMinParams(1);</pre><pre style="margin: 0px"><span style="color: #2b91af">&nbsp;&nbsp;&nbsp;26</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; &nbsp; <span style="color: blue">this</span>.SetMaxParams(1);</pre><pre style="margin: 0px"><span style="color: #2b91af">&nbsp;&nbsp;&nbsp;27</span>&nbsp;</pre><pre style="margin: 0px"><span style="color: #2b91af">&nbsp;&nbsp;&nbsp;28</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; &nbsp; <span style="color: green">//set the function name that needs to be </span></pre><pre style="margin: 0px"><span style="color: #2b91af">&nbsp;&nbsp;&nbsp;29</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; &nbsp; <span style="color: green">//called when this Functoid is invoked. This means that</span></pre><pre style="margin: 0px"><span style="color: #2b91af">&nbsp;&nbsp;&nbsp;30</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; &nbsp; <span style="color: green">//this Functoid assembly need to be present in GAC </span></pre><pre style="margin: 0px"><span style="color: #2b91af">&nbsp;&nbsp;&nbsp;31</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; &nbsp; <span style="color: green">//for its availability during Test..Map and Runtime.</span></pre><pre style="margin: 0px"><span style="color: #2b91af">&nbsp;&nbsp;&nbsp;32</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; &nbsp; SetExternalFunctionName(<span style="color: blue">this</span>.GetType().Assembly.FullName, </pre><pre style="margin: 0px"><span style="color: #2b91af">&nbsp;&nbsp;&nbsp;33</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;<span style="color: blue">this</span>.GetType().FullName, <span style="color: maroon">"LogicalNot"</span>);</pre><pre style="margin: 0px"><span style="color: #2b91af">&nbsp;&nbsp;&nbsp;34</span>&nbsp;</pre><pre style="margin: 0px"><span style="color: #2b91af">&nbsp;&nbsp;&nbsp;35</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; &nbsp; <span style="color: blue">this</span>.Category = <span style="color: teal">FunctoidCategory</span>.Logical;</pre><pre style="margin: 0px"><span style="color: #2b91af">&nbsp;&nbsp;&nbsp;36</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; &nbsp; <span style="color: blue">this</span>.OutputConnectionType = <span style="color: teal">ConnectionType</span>.AllExceptRecord;</pre><pre style="margin: 0px"><span style="color: #2b91af">&nbsp;&nbsp;&nbsp;37</span>&nbsp;</pre><pre style="margin: 0px"><span style="color: #2b91af">&nbsp;&nbsp;&nbsp;38</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; &nbsp; AddInputConnectionType(<span style="color: teal">ConnectionType</span>.AllExceptRecord);</pre><pre style="margin: 0px"><span style="color: #2b91af">&nbsp;&nbsp;&nbsp;39</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp; }</pre></div><p>&nbsp;All that remains now is to create the method which will actually perform the Logical Not.&nbsp; This of course is simple after all of the above as long as you remember that your input value will be a string because all data is a string to XML and as such your boolean will arrive as "true" or "false".&nbsp; I've written this to use System.Convert.ToBoolen so you can also handle inputs like "y" or "n" and the like.</p><!--{\rtf1\ansi\ansicpg\lang1024\noproof1252\uc1 \deff0{\fonttbl{\f0\fnil\fcharset0\fprq1 Consolas;}}{\colortbl;\red0\green0\blue0;\red0\green0\blue255;\red0\green255\blue255;\red0\green255\blue0??;\red255\green0\blue255;\red255\green0\blue0;\red255\green255\blue0;\red255\green255\blue255;??\red0\green0\blue128;\red0\green128\blue128;\red0\green128\blue0;??\red128\green0\blue128;\red128\green0\blue0;\red128\green128\blue0;\red128\green128\blue128;??\red192\green192\blue192;}??\fs28 \cf2 public\cf0\cf2 string\cf0LogicalNot(\cf2 string\cf0booleanValue)\par ??\{\par ??\cf2 bool\cf0bVal = System.\cf10 Convert\cf0 .ToBoolean(booleanValue);\par ??\cf2 if\cf0(bVal)\par ??\cf2 return\cf0\cf13 "false"\cf0 ;\par ??\cf2 else\par ??\cf0 \cf2 return\cf0\cf13 "true"\cf0 ;\par ??\}\par ??}--><div style="font-size: 10pt; background: white; color: black; font-family: consolas, courier"><pre style="margin: 0px"><span style="color: #2b91af">&nbsp;&nbsp;&nbsp;41</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp; <span style="color: blue">public</span> <span style="color: blue">string</span> LogicalNot(<span style="color: blue">string</span> booleanValue)</pre><pre style="margin: 0px"><span style="color: #2b91af">&nbsp;&nbsp;&nbsp;42</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp; {</pre><pre style="margin: 0px"><span style="color: #2b91af">&nbsp;&nbsp;&nbsp;43</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; &nbsp; <span style="color: blue">bool</span> bVal = System.<span style="color: teal">Convert</span>.ToBoolean(booleanValue);</pre><pre style="margin: 0px"><span style="color: #2b91af">&nbsp;&nbsp;&nbsp;44</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; &nbsp; <span style="color: blue">if</span> (bVal)</pre><pre style="margin: 0px"><span style="color: #2b91af">&nbsp;&nbsp;&nbsp;45</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;<span style="color: blue">return</span> <span style="color: maroon">"false"</span>;</pre><pre style="margin: 0px"><span style="color: #2b91af">&nbsp;&nbsp;&nbsp;46</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; &nbsp; <span style="color: blue">else</span></pre><pre style="margin: 0px"><span style="color: #2b91af">&nbsp;&nbsp;&nbsp;47</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;<span style="color: blue">return</span> <span style="color: maroon">"true"</span>;</pre><pre style="margin: 0px"><span style="color: #2b91af">&nbsp;&nbsp;&nbsp;48</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp; }</pre></div><p>&nbsp;Now we just need to compile the project, place it in the GAC, put a copy in <strong>c:\Program Files\Microsoft BizTalk Server 2006\Developer Tools\Mapper&nbsp;Extensions</strong>&nbsp;and then add it to our&nbsp;Toolbox.&nbsp; The result gives us something like this:</p><p><a href="http://www.timrayburn.net/content/binary/WindowsLiveWriter/TimRayburn.CustomFunctoidsLogicalNOT_14E4D/LogicalNotResults4.png" atomicselection="true"><img style="border-top-width: 0px; border-left-width: 0px; border-bottom-width: 0px; border-right-width: 0px" height="156" src="http://www.timrayburn.net/content/binary/WindowsLiveWriter/TimRayburn.CustomFunctoidsLogicalNOT_14E4D/LogicalNotResults_thumb2.png" width="638" border="0"></a> &nbsp;</p><p><a href="http://www.timrayburn.net/content/binary/TimRayburn.CustomFunctoids.v1.0.zip">Download TimRayburn.CustomFunctoids Version 1.0</a></p>
