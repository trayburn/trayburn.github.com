---
title: "How to put PDBs in the GAC"
layout: post
---
<p>This TLA (Three Letter Acronym)&nbsp;littered post is about how to add PDB&nbsp;(Program DataBase)&nbsp;files to the GAC (Global Assembly Cache).&nbsp; </p> <p>Today my current client had the need to get the true source of an exception.&nbsp; They had a catch statement which logged the exception (via log4net) to a file, but the location in question was a poorly designed component with hundreds of lines of code all wrapped within a very large Try-Catch which logged errors.&nbsp; The error was likewise unhelpful as to the source because it was an array out of bounds exception, and this code did alot of string array manipulation.&nbsp; The solution was clear to me, we needed to load the PDB files onto the server so that when an exception was thrown there would be line number information to go with it.&nbsp; <a href="http://www.timrayburn.net/content/binary/WindowsLiveWriter/HowtoputPDBsintheGAC_12BCE/GACDirectories%5B5%5D.png" atomicselection="true"><img style="border-top-width: 0px; border-left-width: 0px; border-bottom-width: 0px; margin: 5px; border-right-width: 0px" height="131" src="http://www.timrayburn.net/content/binary/WindowsLiveWriter/HowtoputPDBsintheGAC_12BCE/GACDirectories_thumb%5B3%5D.png" width="240" align="right" border="0"></a></p> <p>The problem?&nbsp; The assembly was being called by BizTalk Server and as such it was strongly named and in the GAC.</p> <p>The solution?&nbsp; Add the PDB files to the GAC, of course.</p> <p>&nbsp;The Global Assembly Cache which is&nbsp;located at %WINDIR%\assembly ("c:\windows\assembly" on most boxes) is in fact organized into many different directories all of which exist under %WINDIR%\assembly but which by default are hidden from view by Explorer.&nbsp; Fortunately, the command prompt does not suffer the same problems.&nbsp; If you open a command prompt and "cd %windir%\assembly" and do&nbsp;a "dir" you will see several directories as you can see in the first image.</p> <p><a href="http://www.timrayburn.net/content/binary/WindowsLiveWriter/HowtoputPDBsintheGAC_12BCE/AssemblyDirectories%5B4%5D.png" atomicselection="true"><img style="border-top-width: 0px; border-left-width: 0px; border-bottom-width: 0px; margin: 5px; border-right-width: 0px" height="131" src="http://www.timrayburn.net/content/binary/WindowsLiveWriter/HowtoputPDBsintheGAC_12BCE/AssemblyDirectories_thumb%5B2%5D.png" width="240" align="left" border="0"></a> If you change directory to "GAC" you will see a directory for every single assembly in the GAC.&nbsp; From here, cd to the directory for the assembly you want, in my example nunit.framework, and you will see another interesting set of directories.&nbsp; Here you will see one directory for every combination of version number and public key in the GAC.&nbsp; You need to know what version you are working with, and the public key for that.&nbsp; cd into that directory and you will find a copy of your assembly.&nbsp; Now all you have to do is copy your PDB file to this location and your next exception should contain line numbers for the offending code.&nbsp;</p> <p>Since the work to generate line numbers is only done when an exception is being thrown there is little to no reason not to include the PDB files in all your production deployments to the GAC.&nbsp; Yes, generating them takes time, but if you're throwing an exception this shouldn't be a problem.&nbsp; After all, you are treating exceptions as exceptional, right?</p>
