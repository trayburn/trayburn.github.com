---
title: "MapCop v0.1"
layout: post
---
<p>For some time now I've had a side project brewing called MapCop.&nbsp; This program is a code-analysis tool for BizTalk Maps.&nbsp; It works against the uncompiled .BTM files and will ensure a variety of rules are being observed ... eventually.</p> <p>The project has been languishing, and tonight I forced myself to "just do it" and get MapCop to the point it would run at least 1 rule.&nbsp; I've done exactly that.&nbsp; This release, which is <strong>immensely</strong> alpha type release examines the structure of a map to ensure that every link between two functoids has its Label property set.&nbsp; Nothing superbly exciting yet, but the structure exists to do alot more.</p> <p><a href="http://www.timrayburn.net/content/binary/MapCop.zip">You can download the code and files here.</a></p> <p>The rules are written to follow a simple interface which passes in the Map object and allows you to examine it, like so:</p> <p>&nbsp;</p> <div class="wlWriterSmartContent" id="57F11A72-B0E5-49c7-9094-E3A15BD5B5E7:75a7c040-3d31-47f0-aee9-cd5f9c420638" contenteditable="false" style="padding-right: 0px; display: inline; padding-left: 0px; float: none; padding-bottom: 0px; margin: 0px; padding-top: 0px"><pre style="background-color:White;"><div><!--Code highlighting produced by Actipro CodeHighlighter (freeware)http://www.CodeHighlighter.com/--><span style="color: #000000; "></span><span style="color: #0000FF; ">class</span><span style="color: #000000; "> LabelLinksMapRule : IMapRule{</span><span style="color: #0000FF; ">#region</span><span style="color: #000000; "> IMapRule Members</span><span style="color: #000000; "></span><span style="color: #0000FF; ">public</span><span style="color: #000000; "> List</span><span style="color: #000000; ">&lt;</span><span style="color: #000000; ">MapError</span><span style="color: #000000; ">&gt;</span><span style="color: #000000; "> AnalyzeMap(Map map){List</span><span style="color: #000000; ">&lt;</span><span style="color: #000000; ">MapError</span><span style="color: #000000; ">&gt;</span><span style="color: #000000; "> errList </span><span style="color: #000000; ">=</span><span style="color: #000000; "> </span><span style="color: #0000FF; ">new</span><span style="color: #000000; "> List</span><span style="color: #000000; ">&lt;</span><span style="color: #000000; ">MapError</span><span style="color: #000000; ">&gt;</span><span style="color: #000000; ">();</span><span style="color: #0000FF; ">foreach</span><span style="color: #000000; ">(MapPage loopPage </span><span style="color: #0000FF; ">in</span><span style="color: #000000; "> map.Pages){</span><span style="color: #0000FF; ">foreach</span><span style="color: #000000; ">(MapPageLink loopLink </span><span style="color: #0000FF; ">in</span><span style="color: #000000; "> loopPage.Links){</span><span style="color: #0000FF; ">if</span><span style="color: #000000; "> (loopLink.LinkFrom.DestinationType </span><span style="color: #000000; ">==</span><span style="color: #000000; "> LinkDestinationType.Functoid </span><span style="color: #000000; ">&amp;&amp;</span><span style="color: #000000; ">loopLink.LinkTo.DestinationType </span><span style="color: #000000; ">==</span><span style="color: #000000; "> LinkDestinationType.Functoid </span><span style="color: #000000; ">&amp;&amp;</span><span style="color: #000000; ">loopLink.Label.Trim().Length.Equals(</span><span style="color: #000000; ">0</span><span style="color: #000000; ">)){MapError newError </span><span style="color: #000000; ">=</span><span style="color: #000000; "> </span><span style="color: #0000FF; ">new</span><span style="color: #000000; "> MapError();newError.Page </span><span style="color: #000000; ">=</span><span style="color: #000000; "> loopPage;newError.Severity </span><span style="color: #000000; ">=</span><span style="color: #000000; "> ErrorSeverity.High;newError.Title </span><span style="color: #000000; ">=</span><span style="color: #000000; "> </span><span style="color: #000000; ">&quot;</span><span style="color: #000000; ">Label all Links between functoids</span><span style="color: #000000; ">&quot;</span><span style="color: #000000; ">;newError.Description </span><span style="color: #000000; ">=</span><span style="color: #000000; "> </span><span style="color: #000000; ">&quot;</span><span style="color: #000000; ">All links between functoids should have </span><span style="color: #000000; ">&quot;</span><span style="color: #000000; "> </span><span style="color: #000000; ">+</span><span style="color: #000000; "> </span><span style="color: #000000; ">&quot;</span><span style="color: #000000; ">their Label property set to ensure readability of functoid </span><span style="color: #000000; ">&quot;</span><span style="color: #000000; "> </span><span style="color: #000000; ">+</span><span style="color: #000000; "> </span><span style="color: #000000; ">&quot;</span><span style="color: #000000; ">parameter boxes.</span><span style="color: #000000; ">&quot;</span><span style="color: #000000; ">;errList.Add(newError);}}}</span><span style="color: #0000FF; ">return</span><span style="color: #000000; "> errList;}</span><span style="color: #0000FF; ">#endregion</span><span style="color: #000000; ">}</span></div></pre></div>
