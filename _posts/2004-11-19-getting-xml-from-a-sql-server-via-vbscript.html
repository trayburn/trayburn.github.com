---
title: "Getting XML from a SQL Server via VBScript"
layout: post
---
<p>I had reason to help a client the other day automate the transmission of data from a table they controlled in their system to my company on a daily basis in order to allow us to use that data in performing certain operations for them.  Initially they were going to send a tab delimited file, and then I suggested they send XML.  They indicated that they weren't comfortable formatting XML and I said ... “Have SQL Server handle that for you.”  What resulted was an education for them on how to retrieve XML from SQL Server and the following code snippet:</p><span style="FONT-SIZE: 14pt; COLOR: green; FONT-FAMILY: 'Courier New'"><p class="MsoNormal" style="MARGIN: 0in 0in 0pt; mso-layout-grid-align: none"><span style="COLOR: green; FONT-FAMILY: 'Courier New'"><font size="1">'*******************************************************<?xml:namespace prefix = o ns = "urn:schemas-microsoft-com:office:office" /><o:p></o:p></FONT></SPAN></P><P class=MsoNormal style="MARGIN: 0in 0in 0pt; mso-layout-grid-align: none"><SPAN style="COLOR: green; FONT-FAMILY: 'Courier New'"><FONT size=1>'Example code for XML Export of table data<o:p></o:p></FONT></SPAN></P><P class=MsoNormal style="MARGIN: 0in 0in 0pt; mso-layout-grid-align: none"><SPAN style="COLOR: green; FONT-FAMILY: 'Courier New'"><FONT size=1>'*******************************************************<o:p></o:p></FONT></SPAN></P><P class=MsoNormal style="MARGIN: 0in 0in 0pt; mso-layout-grid-align: none"><SPAN style="COLOR: green; FONT-FAMILY: 'Courier New'"><FONT size=1>' By Tim Rayburn, Lead Architect, www.ghnonline.com<o:p></o:p></FONT></SPAN></P><P class=MsoNormal style="MARGIN: 0in 0in 0pt; mso-layout-grid-align: none"><SPAN style="COLOR: green; FONT-FAMILY: 'Courier New'"><FONT size=1>' Date : 09/23/2004<o:p></o:p></FONT></SPAN></P><P class=MsoNormal style="MARGIN: 0in 0in 0pt; mso-layout-grid-align: none"><SPAN style="COLOR: green; FONT-FAMILY: 'Courier New'"><FONT size=1>'*******************************************************<o:p></o:p></FONT></SPAN></P><P class=MsoNormal style="MARGIN: 0in 0in 0pt; mso-layout-grid-align: none"><SPAN style="COLOR: green; FONT-FAMILY: 'Courier New'"><FONT size=1>'This is a modified version of an example file located on msdn.microsoft.com to suit<o:p></o:p></FONT></SPAN></P><P class=MsoNormal style="MARGIN: 0in 0in 0pt; mso-layout-grid-align: none"><SPAN style="COLOR: green; FONT-FAMILY: 'Courier New'"><FONT size=1>'the specific purpose of this example.<SPAN style="mso-spacerun: yes">  </SPAN>The original also used XML for the query, which<o:p></o:p></FONT></SPAN></P><P class=MsoNormal style="MARGIN: 0in 0in 0pt; mso-layout-grid-align: none"><SPAN style="COLOR: green; FONT-FAMILY: 'Courier New'"><FONT size=1>'is not done in this file.<o:p></o:p></FONT></SPAN></P><P class=MsoNormal style="MARGIN: 0in 0in 0pt; mso-layout-grid-align: none"><SPAN style="COLOR: green; FONT-FAMILY: 'Courier New'"><FONT size=1>'*******************************************************<o:p></o:p></FONT></SPAN></P><P class=MsoNormal style="MARGIN: 0in 0in 0pt; mso-layout-grid-align: none"><SPAN style="COLOR: green; FONT-FAMILY: 'Courier New'"><FONT size=1>'Absolutely no warrantly expressed or implied.<o:p></o:p></FONT></SPAN></P><P class=MsoNormal style="MARGIN: 0in 0in 0pt; mso-layout-grid-align: none"><SPAN style="COLOR: green; FONT-FAMILY: 'Courier New'"><FONT size=1>'This code is herby placed in the public domain.<o:p></o:p></FONT></SPAN></P><P class=MsoNormal style="MARGIN: 0in 0in 0pt; mso-layout-grid-align: none"><SPAN style="COLOR: green; FONT-FAMILY: 'Courier New'"><FONT size=1>'*******************************************************<o:p></o:p></FONT></SPAN></P><P class=MsoNormal style="MARGIN: 0in 0in 0pt; mso-layout-grid-align: none"><SPAN style="COLOR: green; FONT-FAMILY: 'Courier New'"><o:p><FONT size=1> </FONT></o:p></SPAN></P><P class=MsoNormal style="MARGIN: 0in 0in 0pt; mso-layout-grid-align: none"><SPAN style="FONT-FAMILY: 'Courier New'"><FONT size=1><SPAN style="mso-tab-count: 1"><FONT color=#000000>     </FONT></SPAN><SPAN style="COLOR: green">'Declare all variables<o:p></o:p></SPAN></FONT></SPAN></P><P class=MsoNormal style="MARGIN: 0in 0in 0pt; mso-layout-grid-align: none"><SPAN style="FONT-FAMILY: 'Courier New'"><FONT size=1><SPAN style="mso-tab-count: 1"><FONT color=#000000>     </FONT></SPAN><SPAN style="COLOR: green">'*******************************************************<o:p></o:p></SPAN></FONT></SPAN></P><P class=MsoNormal style="MARGIN: 0in 0in 0pt; mso-layout-grid-align: none"><SPAN style="FONT-FAMILY: 'Courier New'"><FONT size=1><SPAN style="mso-tab-count: 1"><FONT color=#000000>     </FONT></SPAN><SPAN style="COLOR: blue">Dim</SPAN><FONT color=#000000> adoCmd <SPAN style="mso-tab-count: 1">   </SPAN><SPAN style="mso-tab-count: 1">     </SPAN></FONT><SPAN style="COLOR: green">'<SPAN style="mso-spacerun: yes">   </SPAN>As ADODB.Command<o:p></o:p></SPAN></FONT></SPAN></P><P class=MsoNormal style="MARGIN: 0in 0in 0pt; mso-layout-grid-align: none"><SPAN style="FONT-FAMILY: 'Courier New'"><FONT size=1><SPAN style="mso-tab-count: 1"><FONT color=#000000>     </FONT></SPAN><SPAN style="COLOR: blue">Dim</SPAN><FONT color=#000000> adoConn<SPAN style="mso-tab-count: 1">   </SPAN><SPAN style="mso-tab-count: 1">     </SPAN></FONT><SPAN style="COLOR: green">'<SPAN style="mso-spacerun: yes">   </SPAN>As ADODB.Connection<SPAN style="mso-tab-count: 1"> </SPAN><o:p></o:p></SPAN></FONT></SPAN></P><P class=MsoNormal style="MARGIN: 0in 0in 0pt; mso-layout-grid-align: none"><SPAN style="FONT-FAMILY: 'Courier New'"><FONT size=1><SPAN style="mso-tab-count: 1"><FONT color=#000000>     </FONT></SPAN><SPAN style="COLOR: blue">Dim</SPAN><FONT color=#000000> outStrm<SPAN style="mso-tab-count: 1">   </SPAN><SPAN style="mso-tab-count: 1">     </SPAN></FONT><SPAN style="COLOR: green">'<SPAN style="mso-spacerun: yes">   </SPAN>As ADODB.Stream<o:p></o:p></SPAN></FONT></SPAN></P><P class=MsoNormal style="MARGIN: 0in 0in 0pt; mso-layout-grid-align: none"><SPAN style="FONT-FAMILY: 'Courier New'"><FONT size=1><SPAN style="mso-tab-count: 1"><FONT color=#000000>     </FONT></SPAN><SPAN style="COLOR: blue">Dim</SPAN><FONT color=#000000> txtResults<SPAN style="mso-tab-count: 1"> </SPAN></FONT><SPAN style="COLOR: green">'<SPAN style="mso-spacerun: yes">   </SPAN>String for results<o:p></o:p></SPAN></FONT></SPAN></P><P class=MsoNormal style="MARGIN: 0in 0in 0pt; mso-layout-grid-align: none"><SPAN style="FONT-FAMILY: 'Courier New'"><FONT size=1><SPAN style="mso-tab-count: 1"><FONT color=#000000>     </FONT></SPAN><SPAN style="COLOR: blue">Dim</SPAN><FONT color=#000000> sConn<SPAN style="mso-tab-count: 1"> </SPAN><SPAN style="mso-tab-count: 1">     </SPAN></FONT><SPAN style="COLOR: green">'<SPAN style="mso-spacerun: yes">   </SPAN>String for connection<o:p></o:p></SPAN></FONT></SPAN></P><P class=MsoNormal style="MARGIN: 0in 0in 0pt; mso-layout-grid-align: none"><SPAN style="FONT-FAMILY: 'Courier New'"><FONT size=1><SPAN style="mso-tab-count: 1"><FONT color=#000000>     </FONT></SPAN><SPAN style="COLOR: blue">Dim</SPAN><FONT color=#000000> sQuery<SPAN style="mso-tab-count: 1">    </SPAN><SPAN style="mso-tab-count: 1">     </SPAN></FONT><SPAN style="COLOR: green">'<SPAN style="mso-spacerun: yes">   </SPAN>Query String<o:p></o:p></SPAN></FONT></SPAN></P><P class=MsoNormal style="MARGIN: 0in 0in 0pt; mso-layout-grid-align: none"><SPAN style="FONT-FAMILY: 'Courier New'"><FONT size=1><SPAN style="mso-tab-count: 1"><FONT color=#000000>     </FONT></SPAN><SPAN style="COLOR: blue">Dim</SPAN><FONT color=#000000> fso<SPAN style="mso-tab-count: 1">   </SPAN><SPAN style="mso-tab-count: 2">          </SPAN></FONT><SPAN style="COLOR: green">'File System Object<o:p></o:p></SPAN></FONT></SPAN></P><P class=MsoNormal style="MARGIN: 0in 0in 0pt; mso-layout-grid-align: none"><SPAN style="FONT-FAMILY: 'Courier New'"><FONT size=1><SPAN style="mso-tab-count: 1"><FONT color=#000000>     </FONT></SPAN><SPAN style="COLOR: blue">Dim</SPAN><FONT color=#000000> ts<SPAN style="mso-tab-count: 1">    </SPAN><SPAN style="mso-tab-count: 2">          </SPAN></FONT><SPAN style="COLOR: green">'Text Stream<o:p></o:p></SPAN></FONT></SPAN></P><P class=MsoNormal style="MARGIN: 0in 0in 0pt; mso-layout-grid-align: none"><SPAN style="FONT-FAMILY: 'Courier New'"><FONT color=#000000><FONT size=1><SPAN style="mso-tab-count: 1">     </SPAN><o:p></o:p></FONT></FONT></SPAN></P><P class=MsoNormal style="MARGIN: 0in 0in 0pt; mso-layout-grid-align: none"><SPAN style="FONT-FAMILY: 'Courier New'"><FONT size=1><SPAN style="mso-tab-count: 1"><FONT color=#000000>     </FONT></SPAN><SPAN style="COLOR: blue">Dim</SPAN><FONT color=#000000> dbName<SPAN style="mso-tab-count: 1">    </SPAN><SPAN style="mso-tab-count: 1">     </SPAN></FONT><SPAN style="COLOR: green">'The DNS name or IP address of your DB Server<o:p></o:p></SPAN></FONT></SPAN></P><P class=MsoNormal style="MARGIN: 0in 0in 0pt; mso-layout-grid-align: none"><SPAN style="FONT-FAMILY: 'Courier New'"><FONT size=1><SPAN style="mso-tab-count: 1"><FONT color=#000000>     </FONT></SPAN><SPAN style="COLOR: blue">Dim</SPAN><FONT color=#000000> UID<SPAN style="mso-tab-count: 1">   </SPAN><SPAN style="mso-tab-count: 2">          </SPAN></FONT><SPAN style="COLOR: green">'The User Name to login to your database<o:p></o:p></SPAN></FONT></SPAN></P><P class=MsoNormal style="MARGIN: 0in 0in 0pt; mso-layout-grid-align: none"><SPAN style="FONT-FAMILY: 'Courier New'"><FONT size=1><SPAN style="mso-tab-count: 1"><FONT color=#000000>     </FONT></SPAN><SPAN style="COLOR: blue">Dim</SPAN><FONT color=#000000> PWD<SPAN style="mso-tab-count: 1">   </SPAN><SPAN style="mso-tab-count: 2">          </SPAN></FONT><SPAN style="COLOR: green">'The Password to login to your database<o:p></o:p></SPAN></FONT></SPAN></P><P class=MsoNormal style="MARGIN: 0in 0in 0pt; mso-layout-grid-align: none"><SPAN style="FONT-FAMILY: 'Courier New'"><FONT size=1><SPAN style="mso-tab-count: 1"><FONT color=#000000>     </FONT></SPAN><SPAN style="COLOR: blue">Dim</SPAN><FONT color=#000000> Catalog<SPAN style="mso-tab-count: 1">   </SPAN><SPAN style="mso-tab-count: 1">     </SPAN></FONT><SPAN style="COLOR: green">'The specific database to connect to<o:p></o:p></SPAN></FONT></SPAN></P><P class=MsoNormal style="MARGIN: 0in 0in 0pt; mso-layout-grid-align: none"><SPAN style="FONT-FAMILY: 'Courier New'"><FONT size=1><SPAN style="mso-tab-count: 1"><FONT color=#000000>     </FONT></SPAN><SPAN style="COLOR: blue">Dim</SPAN><FONT color=#000000> TableName<SPAN style="mso-tab-count: 1"> </SPAN><SPAN style="mso-tab-count: 1">     </SPAN></FONT><SPAN style="COLOR: green">'The table we will retrieve data from<o:p></o:p></SPAN></FONT></SPAN></P><P class=MsoNormal style="MARGIN: 0in 0in 0pt; mso-layout-grid-align: none"><SPAN style="FONT-FAMILY: 'Courier New'"><FONT color=#000000><FONT size=1><SPAN style="mso-tab-count: 1">     </SPAN><o:p></o:p></FONT></FONT></SPAN></P><P class=MsoNormal style="MARGIN: 0in 0in 0pt; mso-layout-grid-align: none"><SPAN style="FONT-FAMILY: 'Courier New'"><FONT size=1><SPAN style="mso-tab-count: 1"><FONT color=#000000>     </FONT></SPAN><SPAN style="COLOR: green">'Setup Variable Values (CHANGE THIS TO HAVE THE INFORMATION FOR YOUR DATABASE)<o:p></o:p></SPAN></FONT></SPAN></P><P class=MsoNormal style="MARGIN: 0in 0in 0pt; mso-layout-grid-align: none"><SPAN style="FONT-FAMILY: 'Courier New'"><FONT size=1><SPAN style="mso-tab-count: 1"><FONT color=#000000>     </FONT></SPAN><SPAN style="COLOR: green">'*******************************************************<o:p></o:p></SPAN></FONT></SPAN></P><P class=MsoNormal style="MARGIN: 0in 0in 0pt; mso-layout-grid-align: none"><SPAN style="FONT-FAMILY: 'Courier New'"><FONT color=#000000><FONT size=1><SPAN style="mso-tab-count: 1">     </SPAN>dbName = "DBSERVER"<o:p></o:p></FONT></FONT></SPAN></P><P class=MsoNormal style="MARGIN: 0in 0in 0pt; mso-layout-grid-align: none"><SPAN style="FONT-FAMILY: 'Courier New'"><FONT color=#000000><FONT size=1><SPAN style="mso-tab-count: 1">     </SPAN>UID = "UID"<o:p></o:p></FONT></FONT></SPAN></P><P class=MsoNormal style="MARGIN: 0in 0in 0pt; mso-layout-grid-align: none"><SPAN style="FONT-FAMILY: 'Courier New'"><FONT color=#000000><FONT size=1><SPAN style="mso-tab-count: 1">     </SPAN>PWD = "PWD"<o:p></o:p></FONT></FONT></SPAN></P><P class=MsoNormal style="MARGIN: 0in 0in 0pt; mso-layout-grid-align: none"><SPAN style="FONT-FAMILY: 'Courier New'"><FONT color=#000000><FONT size=1><SPAN style="mso-tab-count: 1">     </SPAN>Catalog = "Northwind"<o:p></o:p></FONT></FONT></SPAN></P><P class=MsoNormal style="MARGIN: 0in 0in 0pt; mso-layout-grid-align: none"><SPAN style="FONT-FAMILY: 'Courier New'"><FONT color=#000000><FONT size=1><SPAN style="mso-tab-count: 1">     </SPAN>TableName = "Employees"<o:p></o:p></FONT></FONT></SPAN></P><P class=MsoNormal style="MARGIN: 0in 0in 0pt; mso-layout-grid-align: none"><SPAN style="FONT-FAMILY: 'Courier New'"><FONT color=#000000><FONT size=1><SPAN style="mso-tab-count: 1">     </SPAN><o:p></o:p></FONT></FONT></SPAN></P><P class=MsoNormal style="MARGIN: 0in 0in 0pt; mso-layout-grid-align: none"><SPAN style="FONT-FAMILY: 'Courier New'"><FONT size=1><SPAN style="mso-tab-count: 1"><FONT color=#000000>     </FONT></SPAN><SPAN style="COLOR: green">'Connect to the database<o:p></o:p></SPAN></FONT></SPAN></P><P class=MsoNormal style="MARGIN: 0in 0in 0pt; mso-layout-grid-align: none"><SPAN style="FONT-FAMILY: 'Courier New'"><FONT size=1><SPAN style="mso-tab-count: 1"><FONT color=#000000>     </FONT></SPAN><SPAN style="COLOR: green">'*******************************************************<o:p></o:p></SPAN></FONT></SPAN></P><P class=MsoNormal style="MARGIN: 0in 0in 0pt; mso-layout-grid-align: none"><SPAN style="FONT-FAMILY: 'Courier New'"><FONT color=#000000><FONT size=1><SPAN style="mso-tab-count: 1">     </SPAN>sConn = "Provider=SQLOLEDB;Data Source=" & dbName <o:p></o:p></FONT></FONT></SPAN></P><P class=MsoNormal style="MARGIN: 0in 0in 0pt; mso-layout-grid-align: none"><SPAN style="FONT-FAMILY: 'Courier New'"><FONT color=#000000><FONT size=1><SPAN style="mso-tab-count: 1">     </SPAN>sConn = sConn & ";Initial Catalog=" & Catalog & ";uid=" & UID & ";pwd=" & PWD<o:p></o:p></FONT></FONT></SPAN></P><P class=MsoNormal style="MARGIN: 0in 0in 0pt; mso-layout-grid-align: none"><SPAN style="FONT-FAMILY: 'Courier New'"><FONT size=1><SPAN style="mso-tab-count: 1"><FONT color=#000000>     </FONT></SPAN><SPAN style="COLOR: blue">Set</SPAN><FONT color=#000000> adoConn = CreateObject("ADODB.Connection")<SPAN style="mso-tab-count: 1">  </SPAN><o:p></o:p></FONT></FONT></SPAN></P><P class=MsoNormal style="MARGIN: 0in 0in 0pt; mso-layout-grid-align: none"><SPAN style="FONT-FAMILY: 'Courier New'"><FONT color=#000000><FONT size=1><SPAN style="mso-tab-count: 1">     </SPAN><o:p></o:p></FONT></FONT></SPAN></P><P class=MsoNormal style="MARGIN: 0in 0in 0pt; mso-layout-grid-align: none"><SPAN style="FONT-FAMILY: 'Courier New'"><FONT color=#000000><FONT size=1><SPAN style="mso-tab-count: 1">     </SPAN>adoConn.ConnectionString = sConn<o:p></o:p></FONT></FONT></SPAN></P><P class=MsoNormal style="MARGIN: 0in 0in 0pt; mso-layout-grid-align: none"><SPAN style="FONT-FAMILY: 'Courier New'"><FONT color=#000000><FONT size=1><SPAN style="mso-tab-count: 1">     </SPAN>adoConn.CursorLocation =<SPAN style="mso-spacerun: yes">  </SPAN>3<o:p></o:p></FONT></FONT></SPAN></P><P class=MsoNormal style="MARGIN: 0in 0in 0pt; mso-layout-grid-align: none"><SPAN style="FONT-FAMILY: 'Courier New'"><FONT color=#000000><FONT size=1><SPAN style="mso-tab-count: 1">     </SPAN><o:p></o:p></FONT></FONT></SPAN></P><P class=MsoNormal style="MARGIN: 0in 0in 0pt; mso-layout-grid-align: none"><SPAN style="FONT-FAMILY: 'Courier New'"><FONT color=#000000><FONT size=1><SPAN style="mso-tab-count: 1">     </SPAN>adoConn.Open<o:p></o:p></FONT></FONT></SPAN></P><P class=MsoNormal style="MARGIN: 0in 0in 0pt; mso-layout-grid-align: none"><SPAN style="FONT-FAMILY: 'Courier New'"><FONT color=#000000><FONT size=1><SPAN style="mso-tab-count: 1">     </SPAN><o:p></o:p></FONT></FONT></SPAN></P><P class=MsoNormal style="MARGIN: 0in 0in 0pt; mso-layout-grid-align: none"><SPAN style="FONT-FAMILY: 'Courier New'"><FONT size=1><SPAN style="mso-tab-count: 1"><FONT color=#000000>     </FONT></SPAN><SPAN style="COLOR: green">'Create the Command Object & Query<o:p></o:p></SPAN></FONT></SPAN></P><P class=MsoNormal style="MARGIN: 0in 0in 0pt; mso-layout-grid-align: none"><SPAN style="FONT-FAMILY: 'Courier New'"><FONT size=1><SPAN style="mso-tab-count: 1"><FONT color=#000000>     </FONT></SPAN><SPAN style="COLOR: green">'*******************************************************<o:p></o:p></SPAN></FONT></SPAN></P><P class=MsoNormal style="MARGIN: 0in 0in 0pt; mso-layout-grid-align: none"><SPAN style="FONT-FAMILY: 'Courier New'"><FONT size=1><SPAN style="mso-tab-count: 1"><FONT color=#000000>     </FONT></SPAN><SPAN style="COLOR: blue">Set</SPAN><FONT color=#000000> adoCmd = CreateObject("ADODB.Command")<SPAN style="mso-spacerun: yes">  </SPAN><o:p></o:p></FONT></FONT></SPAN></P><P class=MsoNormal style="MARGIN: 0in 0in 0pt; mso-layout-grid-align: none"><SPAN style="FONT-FAMILY: 'Courier New'"><FONT size=1><SPAN style="mso-tab-count: 1"><FONT color=#000000>     </FONT></SPAN><SPAN style="COLOR: blue">set</SPAN><FONT color=#000000> adoCmd.ActiveConnection = adoConn<SPAN style="mso-tab-count: 1"> </SPAN><o:p></o:p></FONT></FONT></SPAN></P><P class=MsoNormal style="MARGIN: 0in 0in 0pt; mso-layout-grid-align: none"><SPAN style="FONT-FAMILY: 'Courier New'"><FONT color=#000000><FONT size=1><SPAN style="mso-tab-count: 1">     </SPAN><o:p></o:p></FONT></FONT></SPAN></P><P class=MsoNormal style="MARGIN: 0in 0in 0pt; mso-layout-grid-align: none"><SPAN style="FONT-FAMILY: 'Courier New'"><FONT color=#000000><FONT size=1><SPAN style="mso-tab-count: 1">     </SPAN>sQuery = "SELECT * FROM " & UCase(TableName) & " FOR XML AUTO, ELEMENTS"<o:p></o:p></FONT></FONT></SPAN></P><P class=MsoNormal style="MARGIN: 0in 0in 0pt; mso-layout-grid-align: none"><SPAN style="FONT-FAMILY: 'Courier New'"><FONT color=#000000><FONT size=1><SPAN style="mso-tab-count: 1">     </SPAN><SPAN style="mso-tab-count: 1">     </SPAN><SPAN style="mso-tab-count: 1">     </SPAN><SPAN style="mso-spacerun: yes"> </SPAN><o:p></o:p></FONT></FONT></SPAN></P><P class=MsoNormal style="MARGIN: 0in 0in 0pt; mso-layout-grid-align: none"><SPAN style="FONT-FAMILY: 'Courier New'"><FONT color=#000000><FONT size=1><SPAN style="mso-tab-count: 1">     </SPAN>adoCmd.CommandText = sQuery<o:p></o:p></FONT></FONT></SPAN></P><P class=MsoNormal style="MARGIN: 0in 0in 0pt; mso-layout-grid-align: none"><SPAN style="FONT-FAMILY: 'Courier New'"><o:p><FONT color=#000000 size=1> </FONT></o:p></SPAN></P><P class=MsoNormal style="MARGIN: 0in 0in 0pt; mso-layout-grid-align: none"><SPAN style="FONT-FAMILY: 'Courier New'"><FONT size=1><SPAN style="mso-tab-count: 1"><FONT color=#000000>     </FONT></SPAN><SPAN style="COLOR: green">'Open the output stream and query the database<o:p></o:p></SPAN></FONT></SPAN></P><P class=MsoNormal style="MARGIN: 0in 0in 0pt; mso-layout-grid-align: none"><SPAN style="FONT-FAMILY: 'Courier New'"><FONT size=1><SPAN style="mso-tab-count: 1"><FONT color=#000000>     </FONT></SPAN><SPAN style="COLOR: green">'*******************************************************<o:p></o:p></SPAN></FONT></SPAN></P><P class=MsoNormal style="MARGIN: 0in 0in 0pt; mso-layout-grid-align: none"><SPAN style="FONT-FAMILY: 'Courier New'"><FONT size=1><SPAN style="mso-tab-count: 1"><FONT color=#000000>     </FONT></SPAN><SPAN style="COLOR: blue">Set</SPAN><FONT color=#000000> outStrm = CreateObject("ADODB.Stream")<SPAN style="COLOR: green"><o:p></o:p></SPAN></FONT></FONT></SPAN></P><P class=MsoNormal style="MARGIN: 0in 0in 0pt; mso-layout-grid-align: none"><SPAN style="FONT-FAMILY: 'Courier New'"><FONT color=#000000><FONT size=1><SPAN style="mso-tab-count: 1">     </SPAN>outStrm.Open<o:p></o:p></FONT></FONT></SPAN></P><P class=MsoNormal style="MARGIN: 0in 0in 0pt; mso-layout-grid-align: none"><SPAN style="FONT-FAMILY: 'Courier New'"><FONT color=#000000><FONT size=1><SPAN style="mso-tab-count: 1">     </SPAN>adoCmd.Properties("Output Stream") = outStrm<SPAN style="COLOR: green"><o:p></o:p></SPAN></FONT></FONT></SPAN></P><P class=MsoNormal style="MARGIN: 0in 0in 0pt; mso-layout-grid-align: none"><SPAN style="FONT-FAMILY: 'Courier New'"><FONT color=#000000><FONT size=1><SPAN style="mso-tab-count: 1">     </SPAN>adoCmd.Execute , , 1024 <SPAN style="COLOR: green"><o:p></o:p></SPAN></FONT></FONT></SPAN></P><P class=MsoNormal style="MARGIN: 0in 0in 0pt; mso-layout-grid-align: none"><SPAN style="COLOR: green; FONT-FAMILY: 'Courier New'"><o:p><FONT size=1> </FONT></o:p></SPAN></P><P class=MsoNormal style="MARGIN: 0in 0in 0pt; mso-layout-grid-align: none"><SPAN style="FONT-FAMILY: 'Courier New'"><FONT size=1><SPAN style="mso-tab-count: 1"><FONT color=#000000>     </FONT></SPAN><SPAN style="COLOR: green">'Set to the start of the stream, and then read all data.<o:p></o:p></SPAN></FONT></SPAN></P><P class=MsoNormal style="MARGIN: 0in 0in 0pt; mso-layout-grid-align: none"><SPAN style="FONT-FAMILY: 'Courier New'"><FONT size=1><SPAN style="mso-tab-count: 1"><FONT color=#000000>     </FONT></SPAN><SPAN style="COLOR: green">'*******************************************************<o:p></o:p></SPAN></FONT></SPAN></P><P class=MsoNormal style="MARGIN: 0in 0in 0pt; mso-layout-grid-align: none"><SPAN style="FONT-FAMILY: 'Courier New'"><FONT color=#000000><FONT size=1><SPAN style="mso-tab-count: 1">     </SPAN>outStrm.Position = 0<o:p></o:p></FONT></FONT></SPAN></P><P class=MsoNormal style="MARGIN: 0in 0in 0pt; mso-layout-grid-align: none"><SPAN style="FONT-FAMILY: 'Courier New'"><FONT color=#000000><FONT size=1><SPAN style="mso-tab-count: 1">     </SPAN>txtResults = outStrm.ReadText(-1)<o:p></o:p></FONT></FONT></SPAN></P><P class=MsoNormal style="MARGIN: 0in 0in 0pt; mso-layout-grid-align: none"><SPAN style="FONT-FAMILY: 'Courier New'"><FONT color=#000000><FONT size=1><SPAN style="mso-tab-count: 1">     </SPAN><o:p></o:p></FONT></FONT></SPAN></P><P class=MsoNormal style="MARGIN: 0in 0in 0pt; mso-layout-grid-align: none"><SPAN style="FONT-FAMILY: 'Courier New'"><FONT size=1><SPAN style="mso-tab-count: 1"><FONT color=#000000>     </FONT></SPAN><SPAN style="COLOR: green">'Cleanup Database objects<o:p></o:p></SPAN></FONT></SPAN></P><P class=MsoNormal style="MARGIN: 0in 0in 0pt; mso-layout-grid-align: none"><SPAN style="FONT-FAMILY: 'Courier New'"><FONT size=1><SPAN style="mso-tab-count: 1"><FONT color=#000000>     </FONT></SPAN><SPAN style="COLOR: green">'*******************************************************<o:p></o:p></SPAN></FONT></SPAN></P><P class=MsoNormal style="MARGIN: 0in 0in 0pt; mso-layout-grid-align: none"><SPAN style="FONT-FAMILY: 'Courier New'"><FONT color=#000000><FONT size=1><SPAN style="mso-tab-count: 1">     </SPAN>adoConn.Close<o:p></o:p></FONT></FONT></SPAN></P><P class=MsoNormal style="MARGIN: 0in 0in 0pt; mso-layout-grid-align: none"><SPAN style="FONT-FAMILY: 'Courier New'"><FONT size=1><SPAN style="mso-tab-count: 1"><FONT color=#000000>     </FONT></SPAN><SPAN style="COLOR: blue">set</SPAN><FONT color=#000000> adoConn = </FONT><SPAN style="COLOR: blue">Nothing<o:p></o:p></SPAN></FONT></SPAN></P><P class=MsoNormal style="MARGIN: 0in 0in 0pt; mso-layout-grid-align: none"><SPAN style="FONT-FAMILY: 'Courier New'"><FONT size=1><SPAN style="mso-tab-count: 1"><FONT color=#000000>     </FONT></SPAN><SPAN style="COLOR: blue">set</SPAN><FONT color=#000000> adoCmd = </FONT><SPAN style="COLOR: blue">Nothing<o:p></o:p></SPAN></FONT></SPAN></P><P class=MsoNormal style="MARGIN: 0in 0in 0pt; mso-layout-grid-align: none"><SPAN style="FONT-FAMILY: 'Courier New'"><FONT size=1><SPAN style="mso-tab-count: 1"><FONT color=#000000>     </FONT></SPAN><SPAN style="COLOR: blue">set</SPAN><FONT color=#000000> outStrm = </FONT><SPAN style="COLOR: blue">Nothing</SPAN><FONT color=#000000><SPAN style="mso-tab-count: 1">   </SPAN><o:p></o:p></FONT></FONT></SPAN></P><P class=MsoNormal style="MARGIN: 0in 0in 0pt; mso-layout-grid-align: none"><SPAN style="FONT-FAMILY: 'Courier New'"><FONT color=#000000><FONT size=1><SPAN style="mso-tab-count: 1">     </SPAN><o:p></o:p></FONT></FONT></SPAN></P><P class=MsoNormal style="MARGIN: 0in 0in 0pt; mso-layout-grid-align: none"><SPAN style="FONT-FAMILY: 'Courier New'"><FONT size=1><SPAN style="mso-tab-count: 1"><FONT color=#000000>     </FONT></SPAN><SPAN style="COLOR: green">'Output to a file<o:p></o:p></SPAN></FONT></SPAN></P><P class=MsoNormal style="MARGIN: 0in 0in 0pt; mso-layout-grid-align: none"><SPAN style="FONT-FAMILY: 'Courier New'"><FONT size=1><SPAN style="mso-tab-count: 1"><FONT color=#000000>     </FONT></SPAN><SPAN style="COLOR: green">'*******************************************************<o:p></o:p></SPAN></FONT></SPAN></P><P class=MsoNormal style="MARGIN: 0in 0in 0pt; mso-layout-grid-align: none"><SPAN style="FONT-FAMILY: 'Courier New'"><FONT size=1><SPAN style="mso-tab-count: 1"><FONT color=#000000>     </FONT></SPAN><SPAN style="COLOR: blue">set</SPAN><FONT color=#000000> fso = CreateObject("Scripting.FileSystemObject")<o:p></o:p></FONT></FONT></SPAN></P><P class=MsoNormal style="MARGIN: 0in 0in 0pt; mso-layout-grid-align: none"><SPAN style="FONT-FAMILY: 'Courier New'"><FONT color=#000000><FONT size=1><SPAN style="mso-tab-count: 1">     </SPAN><o:p></o:p></FONT></FONT></SPAN></P><P class=MsoNormal style="MARGIN: 0in 0in 0pt; mso-layout-grid-align: none"><SPAN style="FONT-FAMILY: 'Courier New'"><FONT size=1><SPAN style="mso-tab-count: 1"><FONT color=#000000>     </FONT></SPAN><SPAN style="COLOR: blue">set</SPAN><FONT color=#000000> ts = fso.CreateTextFile("OutputFile.xml")<o:p></o:p></FONT></FONT></SPAN></P><P class=MsoNormal style="MARGIN: 0in 0in 0pt; mso-layout-grid-align: none"><SPAN style="FONT-FAMILY: 'Courier New'"><FONT color=#000000><FONT size=1><SPAN style="mso-tab-count: 1">     </SPAN>ts.Write "<" & Ucase(TableName) & "Table>"<o:p></o:p></FONT></FONT></SPAN></P><P class=MsoNormal style="MARGIN: 0in 0in 0pt; TEXT-INDENT: 0.5in; mso-layout-grid-align: none"><SPAN style="FONT-FAMILY: 'Courier New'"><FONT color=#000000><FONT size=1>ts.Write txtResults <o:p></o:p></FONT></FONT></SPAN></P><P class=MsoNormal style="MARGIN: 0in 0in 0pt; TEXT-INDENT: 0.5in; mso-layout-grid-align: none"><SPAN style="FONT-FAMILY: 'Courier New'"><FONT color=#000000><FONT size=1>ts.Write "</" UCase(TableName) & ?Table></FONT></FONT></SPAN></P><P class=MsoNormal style="MARGIN: 0in 0in 0pt; mso-layout-grid-align: none"><SPAN style="FONT-FAMILY: 'Courier New'"><FONT color=#000000><FONT size=1><SPAN style="mso-tab-count: 1">     </SPAN>ts.Close<o:p></o:p></FONT></FONT></SPAN></P><P class=MsoNormal style="MARGIN: 0in 0in 0pt; mso-layout-grid-align: none"><SPAN style="FONT-FAMILY: 'Courier New'"><FONT color=#000000><FONT size=1><SPAN style="mso-tab-count: 1">     </SPAN><o:p></o:p></FONT></FONT></SPAN></P><P class=MsoNormal style="MARGIN: 0in 0in 0pt; mso-layout-grid-align: none"><SPAN style="FONT-FAMILY: 'Courier New'"><FONT size=1><SPAN style="mso-tab-count: 1"><FONT color=#000000>     </FONT></SPAN><SPAN style="COLOR: green">'Cleanup File write objects<o:p></o:p></SPAN></FONT></SPAN></P><P class=MsoNormal style="MARGIN: 0in 0in 0pt; mso-layout-grid-align: none"><SPAN style="FONT-FAMILY: 'Courier New'"><FONT size=1><SPAN style="mso-tab-count: 1"><FONT color=#000000>     </FONT></SPAN><SPAN style="COLOR: green">'*******************************************************<o:p></o:p></SPAN></FONT></SPAN></P><P class=MsoNormal style="MARGIN: 0in 0in 0pt; mso-layout-grid-align: none"><SPAN style="FONT-FAMILY: 'Courier New'"><FONT size=1><SPAN style="mso-tab-count: 1"><FONT color=#000000>     </FONT></SPAN><SPAN style="COLOR: blue">set</SPAN><FONT color=#000000> fso = </FONT><SPAN style="COLOR: blue">Nothing<o:p></o:p></SPAN></FONT></SPAN></P><P class=MsoNormal style="MARGIN: 0in 0in 0pt; mso-layout-grid-align: none"><SPAN style="FONT-FAMILY: 'Courier New'"><FONT size=1><SPAN style="mso-tab-count: 1"><FONT color=#000000>     </FONT></SPAN><SPAN style="COLOR: blue">set</SPAN><FONT color=#000000> ts = </FONT><SPAN style="COLOR: blue">Nothing</SPAN></FONT></SPAN></SPAN></P></SPAN></BLOGHELPER><FONT size=1>?></font></span></p><p></p></span>
