---
title: "Extension Methods - TimRayburn.Extensions Beta v0.1"
layout: post
---
<p>I've had a chance over the last few days to play some more with the March CTP of Visual Studio Codename "Orcas" and with the features being added as a part of C# 3.0.&nbsp; Even while feeling utterly handicap in Visual Studio without CodeRush and Refactor! Pro, I've managed turn out an interesting little assembly that I intend to grow as time goes with the namespace TimRayburn.Extensions.&nbsp; As you might guess this assembly contains Extension methods to classes within the Framework.</p> <p>In case you don't know what extension methods are, they are static methods in static classes which use a special syntax to indicate that they extend an existing class or interface.&nbsp; For instance you might write some code like:</p> <div> <div class="csharpcode"><pre class="alt"><span class="lnum"> 1:</span> <span class="kwrd">public</span> <span class="kwrd">static</span> <span class="kwrd">string</span> ToStringNullSafe(<span class="kwrd">this</span> <span class="kwrd">object</span> inStr)</pre><pre><span class="lnum"> 2:</span> {</pre><pre class="alt"><span class="lnum"> 3:</span> <span class="kwrd">if</span> (inStr == <span class="kwrd">null</span>) <span class="kwrd">return</span> <span class="kwrd">string</span>.Empty;</pre><pre><span class="lnum"> 4:</span> <span class="kwrd">else</span></pre><pre class="alt"><span class="lnum"> 5:</span> {</pre><pre><span class="lnum"> 6:</span> <span class="kwrd">string</span> lStr = inStr.ToString();</pre><pre class="alt"><span class="lnum"> 7:</span> <span class="kwrd">if</span> (lStr == <span class="kwrd">null</span>) <span class="kwrd">return</span> <span class="kwrd">string</span>.Empty;</pre><pre><span class="lnum"> 8:</span> <span class="kwrd">else</span> <span class="kwrd">return</span> lStr;</pre><pre class="alt"><span class="lnum"> 9:</span> }</pre><pre><span class="lnum">10:</span> }</pre></div><style type="text/css">.csharpcode-wrapper, .csharpcode-wrapper pre {background-color: #f4f4f4;border: solid 1px gray;cursor: text;font-family: consolas, 'Courier New', courier, monospace;font-size: 8pt;line-height: 12pt;margin: 20px 0px 10px 0px;max-height: 200px;overflow: auto;padding: 4px 4px 4px 4px;width: 97.5%;}.csharpcode-wrapper pre {border-style: none;margin: 0px 0px 0px 0px;overflow: visible;padding: 0px 0px 0px 0px;}.csharpcode, .csharpcode pre, .csharpcode .alt {background-color: #f4f4f4;border-style: none;color: black;font-family: consolas, 'Courier New', courier, monospace;font-size: 8pt;line-height: 12pt;overflow: visible;padding: 0px 0px 0px 0px;width: 100%;}.csharpcode pre {margin: 0em;}.csharpcode .alt {background-color: white;}.csharpcode .asp {background-color: #ffff00;}.csharpcode .attr {color: #ff0000;}.csharpcode .html {color: #800000;}.csharpcode .kwrd {color: #0000ff;}.csharpcode .lnum {color: #606060;}.csharpcode .op {color: #0000c0;}.csharpcode .preproc {color: #cc6633;}.csharpcode .rem {color: #008000;}.csharpcode .str {color: #006080;}</style></div><p><a href="http://www.timrayburn.net/content/binary/WindowsLiveWriter/ExtensionMethodsTimRayburn.ExtensionsB.1_1446A/Extension%20Method%20Intellisense%5B13%5D.jpg" atomicselection="true"><img style="margin: 5px" height="231" src="http://www.timrayburn.net/content/binary/WindowsLiveWriter/ExtensionMethodsTimRayburn.ExtensionsB.1_1446A/Extension%20Method%20Intellisense_thumb%5B11%5D.jpg" width="377" align="right"></a> Which extends the class System.Object to contain a new method called ToStringNullSafe which, as you can see, returns String.Empty instead of throwing Exceptions when a the object being called is null or it's ToString value is null.&nbsp; The intellisense for this looks like the image to the right.</p><p>I intend to use TimRayburn.Extensions to contain extension methods which I've written and find useful.&nbsp; Version 0.1 addresses very simple problems, but over time I'm sure more complex functions will be added.&nbsp; For now there are two classes in the project FrameworkExtensions and EnsureExtensions.</p><p>Framework Extensions contains three methods today.&nbsp; ToStringNullSafe (as seen above) extends System.Object to provide a ToString method which will not throw exceptions on null.&nbsp; ToInt32 extends System.String to provide the ability to convert to a System.Int32 inline.&nbsp; Likewise ToDouble extends System.String for conversion to System.Double.&nbsp; These extensions are simple and without a unifying purpose other than that I thought they would come in handy.&nbsp; Nothing being done here, or in EnsureExtensions, that can't be done without extension methods, just easier and more reader friendly code.</p><p>EnsureExtensions contains many methods which extend either System.Object, System.String or objects which implement IComparable&lt;T&gt;.&nbsp; Every method in this class follows the naming convention Ensure<em>X</em> where <em>X</em> is something you would want to confirm about the datatype before using it in code.&nbsp; The first of these is EnsureNotNull, an extension to System.Object, which checks if the object being used is null, and if it is throws an ArgumentException but if not it simply returns the object.&nbsp; This allows for interesting pieces of code like:</p><div><div class="csharpcode"><pre class="alt"><span class="lnum"> 1:</span> <span class="kwrd">public</span> <span class="kwrd">void</span> MyExampleMethod(<span class="kwrd">string</span> inputData)</pre><pre><span class="lnum"> 2:</span> {</pre><pre class="alt"><span class="lnum"> 3:</span> inputData.EnsureNotNull().EnsureGreaterThan(<span class="str">"Bravo"</span>).EnsureLessThan(<span class="str">"Charlie"</span>);</pre><pre><span class="lnum"> 4:</span> &nbsp;</pre><pre class="alt"><span class="lnum"> 5:</span> <span class="rem">// Real code here now that arguments have been checked.</span></pre><pre><span class="lnum"> 6:</span> }</pre></div><style type="text/css">.csharpcode-wrapper, .csharpcode-wrapper pre {background-color: #f4f4f4;border: solid 1px gray;cursor: text;font-family: consolas, 'Courier New', courier, monospace;font-size: 8pt;line-height: 12pt;margin: 20px 0px 10px 0px;max-height: 200px;overflow: auto;padding: 4px 4px 4px 4px;width: 97.5%;}.csharpcode-wrapper pre {border-style: none;margin: 0px 0px 0px 0px;overflow: visible;padding: 0px 0px 0px 0px;}.csharpcode, .csharpcode pre, .csharpcode .alt {background-color: #f4f4f4;border-style: none;color: black;font-family: consolas, 'Courier New', courier, monospace;font-size: 8pt;line-height: 12pt;overflow: visible;padding: 0px 0px 0px 0px;width: 100%;}.csharpcode pre {margin: 0em;}.csharpcode .alt {background-color: white;}.csharpcode .asp {background-color: #ffff00;}.csharpcode .attr {color: #ff0000;}.csharpcode .html {color: #800000;}.csharpcode .kwrd {color: #0000ff;}.csharpcode .lnum {color: #606060;}.csharpcode .op {color: #0000c0;}.csharpcode .preproc {color: #cc6633;}.csharpcode .rem {color: #008000;}.csharpcode .str {color: #006080;}</style></div><p>The observant among you might notice that this sort of methodology could also be extended to handle NUnit Assert's, and I assure you that has not gone unnoticed by me.&nbsp; Extension methods may very well provide some interesting Syntactic Glue for many things in the future.&nbsp; Not rocket science, but very cool, and in my opinion very readable.</p><p>You can download the code for this below, though you will need the CTP of Orcas to compile this code.</p><h2><a href="http://www.timrayburn.net/content/binary/TimRayburn.Extensions.zip">Download TimRayburn.Extensions</a></h2>
