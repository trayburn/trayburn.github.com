---
title: "Code Generation and Visual Studio 2003"
layout: post
---
<P>I've had a chance recently to speak with people about Code Generation and problems they perceived using Visual Studio 2003.&nbsp; Everyone is quick to point out that <STRONG>partial</STRONG> classes will solve alot of the problems with Code Generation when we have Visual Studio 2005, but they find it tedious or difficult to extend classes they have generated and then late regenerate them in Visual Studio 2003.&nbsp; Still, there are several perfectly good options for this in VS03.</P><OL><LI>Generate <STRONG>abstract</STRONG> classes which you then inherit from.&nbsp; Particularly useful for data access layers, this would produce an Abstract<EM>TableName </EM>and then a simply 3 line <EM>TableName</EM> class. For example, if your table was named Customer and you were writing in VB, you would have AbstractCustomer.vb which looks like:<BR><BR><P class=MsoNormal style="MARGIN: 0in 0in 0pt; mso-layout-grid-align: none"><SPAN style="FONT-SIZE: 10pt; COLOR: green; FONT-FAMILY: 'Courier New'">'This is a class generated by your favorite Code Generation utility<?xml:namespace prefix = o ns = "urn:schemas-microsoft-com:office:office" /><o:p></o:p></SPAN></P><P class=MsoNormal style="MARGIN: 0in 0in 0pt; mso-layout-grid-align: none"><SPAN style="FONT-SIZE: 10pt; COLOR: green; FONT-FAMILY: 'Courier New'">'such as CodeSmith (www.codesmithtools.com)<o:p></o:p></SPAN></P><P class=MsoNormal style="MARGIN: 0in 0in 0pt; mso-layout-grid-align: none"><SPAN style="FONT-SIZE: 10pt; COLOR: blue; FONT-FAMILY: 'Courier New'">Public</SPAN><SPAN style="FONT-SIZE: 10pt; FONT-FAMILY: 'Courier New'"> <SPAN style="COLOR: blue">MustInherit</SPAN> <SPAN style="COLOR: blue">Class</SPAN> AbstractCustomers<o:p></o:p></SPAN></P><P class=MsoNormal style="MARGIN: 0in 0in 0pt; mso-layout-grid-align: none"><SPAN style="FONT-SIZE: 10pt; FONT-FAMILY: 'Courier New'"><SPAN style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp; </SPAN><SPAN style="COLOR: green">'Generated properties and code go here...<o:p></o:p></SPAN></SPAN></P><P class=MsoNormal style="MARGIN: 0in 0in 0pt"><SPAN style="FONT-SIZE: 10pt; COLOR: blue; FONT-FAMILY: 'Courier New'">End</SPAN><SPAN style="FONT-SIZE: 10pt; FONT-FAMILY: 'Courier New'"> <SPAN style="COLOR: blue">Class<BR><BR><FONT face="Times New Roman" color=#000000 size=3>And a Customer.vb file which you did not generate which started containing only:<BR></P><P class=MsoNormal style="MARGIN: 0in 0in 0pt; mso-layout-grid-align: none"><SPAN style="FONT-SIZE: 10pt; COLOR: blue; FONT-FAMILY: 'Courier New'">Public</SPAN><SPAN style="FONT-SIZE: 10pt; FONT-FAMILY: 'Courier New'"> <SPAN style="COLOR: blue">Class</SPAN> Customers<o:p></o:p></SPAN></P><P class=MsoNormal style="MARGIN: 0in 0in 0pt; mso-layout-grid-align: none"><SPAN style="FONT-SIZE: 10pt; FONT-FAMILY: 'Courier New'"><SPAN style="mso-spacerun: yes">&nbsp;&nbsp;&nbsp; </SPAN><SPAN style="COLOR: blue">Inherits</SPAN> AbstractCustomers<o:p></o:p></SPAN></P><P class=MsoNormal style="MARGIN: 0in 0in 0pt"><SPAN style="FONT-SIZE: 10pt; COLOR: blue; FONT-FAMILY: 'Courier New'">End</SPAN><SPAN style="FONT-SIZE: 10pt; FONT-FAMILY: 'Courier New'"> <SPAN style="COLOR: blue">Class</SPAN></SPAN></P></FONT></SPAN></SPAN></LI><LI><SPAN style="FONT-SIZE: 10pt; FONT-FAMILY: 'Courier New'"><SPAN style="COLOR: blue"><FONT color=#000000><P class=MsoNormal style="MARGIN: 0in 0in 0pt"><SPAN style="FONT-SIZE: 10pt; FONT-FAMILY: 'Courier New'"><SPAN style="COLOR: blue"><FONT face="Times New Roman" color=#000000 size=3>Another valid option is to use preservation regions, a feature in my favorite code generation utility CodeSmith.&nbsp; This allows you to create a region which will be left, untouched, after you regenerate the file</FONT></SPAN></SPAN></P></FONT></SPAN></SPAN></LI></OL><SPAN style="FONT-SIZE: 10pt; FONT-FAMILY: 'Courier New'"><SPAN style="COLOR: blue"><FONT color=#000000><P class=MsoNormal style="MARGIN: 0in 0in 0pt"><SPAN style="FONT-SIZE: 10pt; FONT-FAMILY: 'Courier New'"><SPAN style="COLOR: blue"><FONT face="Times New Roman" color=#000000 size=3>Certainly we will have an easier time once we have partial classes, but as it will take time for shops to upgrade, you can call these techniques when you have to generate code and then extend upon the generation.</FONT></SPAN></SPAN></FONT></SPAN></SPAN></P>
