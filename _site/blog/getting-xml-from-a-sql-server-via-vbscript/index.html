<!DOCTYPE html>
<html class="no-js" lang="en-US" data-cursor="ec008c">
  <head>

  <!-- Meta Tags -->
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <meta name="viewport" content="width=device-width">
  <meta name="description" content="Write an awesome description for your new site here. You can edit this line in _config.yml. It will appear in your document head meta (for Google search results) and in your feed.xml site description.">

  <title>TimRayburn.net - Getting XML from a SQL Server via VBScript</title>

  <!-- Stylesheets -->
  <link rel="stylesheet" type="text/css" href="/style.css" media="all">

  <!-- Javascripts -->
  <script type="text/javascript" src="/assets/js/modernizr.js"></script>
  <script type="text/javascript" src="/assets/js/detection.js"></script>

</head>

  <body class="single-blog sticky-nav">
    <section class="container">
      <header id="masthead" class="site-header--fixed site-header" role="banner">
  <div class="row">

    <div id="logo" class="site-logo">

      <a href="index.html">
        <img src="/assets/images/site-logo.png" alt="This is the logo">
      </a>

    </div>

    
<div class="navbar">
  <nav class="site-navigation navigation">
    <ul id="primary" class="primary-menu">
      <li >
        <a href="/">Home</a>
      </li>
      
      <li >
        <a href="/consulting">Consulting</a>
      </li>
      
      <li >
        <a href="/community">Community</a>
      </li>
      
      <li >
        <a href="/creativity">Creativity</a>
      </li>
      
      <li >
        <a href="/contact">Contact</a>
      </li>
      
    </ul>

    <a href="#" class="nav-toggle icon-menu" aria-hidden="false"></a>
  </nav>
</div>

  </div>
</header>

      <div id="custom-header" class="site-background" data-image="dallas-skyline-1280-850.jpg" data-opacity="0.50" data-color="181a25">
  <div id="tagline" class="site-tagline row">
    <h1>
      Getting XML from a SQL Server via VBScript
    </h1>
    <h2>
      
    </h2>
  </div>
</div>

      <section id="main" class="site-content row" role="main">
        <div class="blog--section-block clearfix">
  <div id="blog" class="blog-content">
    <div class="format format-image">
      <header class="page-header blog-title">
        <div class="post-meta">
          <p>
            Published at: <span class="publish-on">Nov 19, 2004</span>
          </p>
        </div>
      </header>
      
      <article>
        <div class="blog-subtitle">
          
          <p>
            <p>I had reason to help a client the other day automate the transmission of data from a table they controlled in their system to my company on a daily basis in order to allow us to use that data in performing certain operations for them.  Initially they were going to send a tab delimited file, and then I suggested they send XML.  They indicated that they weren't comfortable formatting XML and I said ... “Have SQL Server handle that for you.”  What resulted was an education for them on how to retrieve XML from SQL Server and the following code snippet:</p><span style="FONT-SIZE: 14pt; COLOR: green; FONT-FAMILY: 'Courier New'"><p class="MsoNormal" style="MARGIN: 0in 0in 0pt; mso-layout-grid-align: none"><span style="COLOR: green; FONT-FAMILY: 'Courier New'"><font size="1">'*******************************************************<?xml:namespace prefix = o ns = "urn:schemas-microsoft-com:office:office" /><o:p></o:p></FONT></SPAN></P><P class=MsoNormal style="MARGIN: 0in 0in 0pt; mso-layout-grid-align: none"><SPAN style="COLOR: green; FONT-FAMILY: 'Courier New'"><FONT size=1>'Example code for XML Export of table data<o:p></o:p></FONT></SPAN></P><P class=MsoNormal style="MARGIN: 0in 0in 0pt; mso-layout-grid-align: none"><SPAN style="COLOR: green; FONT-FAMILY: 'Courier New'"><FONT size=1>'*******************************************************<o:p></o:p></FONT></SPAN></P><P class=MsoNormal style="MARGIN: 0in 0in 0pt; mso-layout-grid-align: none"><SPAN style="COLOR: green; FONT-FAMILY: 'Courier New'"><FONT size=1>' By Tim Rayburn, Lead Architect, www.ghnonline.com<o:p></o:p></FONT></SPAN></P><P class=MsoNormal style="MARGIN: 0in 0in 0pt; mso-layout-grid-align: none"><SPAN style="COLOR: green; FONT-FAMILY: 'Courier New'"><FONT size=1>' Date : 09/23/2004<o:p></o:p></FONT></SPAN></P><P class=MsoNormal style="MARGIN: 0in 0in 0pt; mso-layout-grid-align: none"><SPAN style="COLOR: green; FONT-FAMILY: 'Courier New'"><FONT size=1>'*******************************************************<o:p></o:p></FONT></SPAN></P><P class=MsoNormal style="MARGIN: 0in 0in 0pt; mso-layout-grid-align: none"><SPAN style="COLOR: green; FONT-FAMILY: 'Courier New'"><FONT size=1>'This is a modified version of an example file located on msdn.microsoft.com to suit<o:p></o:p></FONT></SPAN></P><P class=MsoNormal style="MARGIN: 0in 0in 0pt; mso-layout-grid-align: none"><SPAN style="COLOR: green; FONT-FAMILY: 'Courier New'"><FONT size=1>'the specific purpose of this example.<SPAN style="mso-spacerun: yes">  </SPAN>The original also used XML for the query, which<o:p></o:p></FONT></SPAN></P><P class=MsoNormal style="MARGIN: 0in 0in 0pt; mso-layout-grid-align: none"><SPAN style="COLOR: green; FONT-FAMILY: 'Courier New'"><FONT size=1>'is not done in this file.<o:p></o:p></FONT></SPAN></P><P class=MsoNormal style="MARGIN: 0in 0in 0pt; mso-layout-grid-align: none"><SPAN style="COLOR: green; FONT-FAMILY: 'Courier New'"><FONT size=1>'*******************************************************<o:p></o:p></FONT></SPAN></P><P class=MsoNormal style="MARGIN: 0in 0in 0pt; mso-layout-grid-align: none"><SPAN style="COLOR: green; FONT-FAMILY: 'Courier New'"><FONT size=1>'Absolutely no warrantly expressed or implied.<o:p></o:p></FONT></SPAN></P><P class=MsoNormal style="MARGIN: 0in 0in 0pt; mso-layout-grid-align: none"><SPAN style="COLOR: green; FONT-FAMILY: 'Courier New'"><FONT size=1>'This code is herby placed in the public domain.<o:p></o:p></FONT></SPAN></P><P class=MsoNormal style="MARGIN: 0in 0in 0pt; mso-layout-grid-align: none"><SPAN style="COLOR: green; FONT-FAMILY: 'Courier New'"><FONT size=1>'*******************************************************<o:p></o:p></FONT></SPAN></P><P class=MsoNormal style="MARGIN: 0in 0in 0pt; mso-layout-grid-align: none"><SPAN style="COLOR: green; FONT-FAMILY: 'Courier New'"><o:p><FONT size=1> </FONT></o:p></SPAN></P><P class=MsoNormal style="MARGIN: 0in 0in 0pt; mso-layout-grid-align: none"><SPAN style="FONT-FAMILY: 'Courier New'"><FONT size=1><SPAN style="mso-tab-count: 1"><FONT color=#000000>     </FONT></SPAN><SPAN style="COLOR: green">'Declare all variables<o:p></o:p></SPAN></FONT></SPAN></P><P class=MsoNormal style="MARGIN: 0in 0in 0pt; mso-layout-grid-align: none"><SPAN style="FONT-FAMILY: 'Courier New'"><FONT size=1><SPAN style="mso-tab-count: 1"><FONT color=#000000>     </FONT></SPAN><SPAN style="COLOR: green">'*******************************************************<o:p></o:p></SPAN></FONT></SPAN></P><P class=MsoNormal style="MARGIN: 0in 0in 0pt; mso-layout-grid-align: none"><SPAN style="FONT-FAMILY: 'Courier New'"><FONT size=1><SPAN style="mso-tab-count: 1"><FONT color=#000000>     </FONT></SPAN><SPAN style="COLOR: blue">Dim</SPAN><FONT color=#000000> adoCmd <SPAN style="mso-tab-count: 1">   </SPAN><SPAN style="mso-tab-count: 1">     </SPAN></FONT><SPAN style="COLOR: green">'<SPAN style="mso-spacerun: yes">   </SPAN>As ADODB.Command<o:p></o:p></SPAN></FONT></SPAN></P><P class=MsoNormal style="MARGIN: 0in 0in 0pt; mso-layout-grid-align: none"><SPAN style="FONT-FAMILY: 'Courier New'"><FONT size=1><SPAN style="mso-tab-count: 1"><FONT color=#000000>     </FONT></SPAN><SPAN style="COLOR: blue">Dim</SPAN><FONT color=#000000> adoConn<SPAN style="mso-tab-count: 1">   </SPAN><SPAN style="mso-tab-count: 1">     </SPAN></FONT><SPAN style="COLOR: green">'<SPAN style="mso-spacerun: yes">   </SPAN>As ADODB.Connection<SPAN style="mso-tab-count: 1"> </SPAN><o:p></o:p></SPAN></FONT></SPAN></P><P class=MsoNormal style="MARGIN: 0in 0in 0pt; mso-layout-grid-align: none"><SPAN style="FONT-FAMILY: 'Courier New'"><FONT size=1><SPAN style="mso-tab-count: 1"><FONT color=#000000>     </FONT></SPAN><SPAN style="COLOR: blue">Dim</SPAN><FONT color=#000000> outStrm<SPAN style="mso-tab-count: 1">   </SPAN><SPAN style="mso-tab-count: 1">     </SPAN></FONT><SPAN style="COLOR: green">'<SPAN style="mso-spacerun: yes">   </SPAN>As ADODB.Stream<o:p></o:p></SPAN></FONT></SPAN></P><P class=MsoNormal style="MARGIN: 0in 0in 0pt; mso-layout-grid-align: none"><SPAN style="FONT-FAMILY: 'Courier New'"><FONT size=1><SPAN style="mso-tab-count: 1"><FONT color=#000000>     </FONT></SPAN><SPAN style="COLOR: blue">Dim</SPAN><FONT color=#000000> txtResults<SPAN style="mso-tab-count: 1"> </SPAN></FONT><SPAN style="COLOR: green">'<SPAN style="mso-spacerun: yes">   </SPAN>String for results<o:p></o:p></SPAN></FONT></SPAN></P><P class=MsoNormal style="MARGIN: 0in 0in 0pt; mso-layout-grid-align: none"><SPAN style="FONT-FAMILY: 'Courier New'"><FONT size=1><SPAN style="mso-tab-count: 1"><FONT color=#000000>     </FONT></SPAN><SPAN style="COLOR: blue">Dim</SPAN><FONT color=#000000> sConn<SPAN style="mso-tab-count: 1"> </SPAN><SPAN style="mso-tab-count: 1">     </SPAN></FONT><SPAN style="COLOR: green">'<SPAN style="mso-spacerun: yes">   </SPAN>String for connection<o:p></o:p></SPAN></FONT></SPAN></P><P class=MsoNormal style="MARGIN: 0in 0in 0pt; mso-layout-grid-align: none"><SPAN style="FONT-FAMILY: 'Courier New'"><FONT size=1><SPAN style="mso-tab-count: 1"><FONT color=#000000>     </FONT></SPAN><SPAN style="COLOR: blue">Dim</SPAN><FONT color=#000000> sQuery<SPAN style="mso-tab-count: 1">    </SPAN><SPAN style="mso-tab-count: 1">     </SPAN></FONT><SPAN style="COLOR: green">'<SPAN style="mso-spacerun: yes">   </SPAN>Query String<o:p></o:p></SPAN></FONT></SPAN></P><P class=MsoNormal style="MARGIN: 0in 0in 0pt; mso-layout-grid-align: none"><SPAN style="FONT-FAMILY: 'Courier New'"><FONT size=1><SPAN style="mso-tab-count: 1"><FONT color=#000000>     </FONT></SPAN><SPAN style="COLOR: blue">Dim</SPAN><FONT color=#000000> fso<SPAN style="mso-tab-count: 1">   </SPAN><SPAN style="mso-tab-count: 2">          </SPAN></FONT><SPAN style="COLOR: green">'File System Object<o:p></o:p></SPAN></FONT></SPAN></P><P class=MsoNormal style="MARGIN: 0in 0in 0pt; mso-layout-grid-align: none"><SPAN style="FONT-FAMILY: 'Courier New'"><FONT size=1><SPAN style="mso-tab-count: 1"><FONT color=#000000>     </FONT></SPAN><SPAN style="COLOR: blue">Dim</SPAN><FONT color=#000000> ts<SPAN style="mso-tab-count: 1">    </SPAN><SPAN style="mso-tab-count: 2">          </SPAN></FONT><SPAN style="COLOR: green">'Text Stream<o:p></o:p></SPAN></FONT></SPAN></P><P class=MsoNormal style="MARGIN: 0in 0in 0pt; mso-layout-grid-align: none"><SPAN style="FONT-FAMILY: 'Courier New'"><FONT color=#000000><FONT size=1><SPAN style="mso-tab-count: 1">     </SPAN><o:p></o:p></FONT></FONT></SPAN></P><P class=MsoNormal style="MARGIN: 0in 0in 0pt; mso-layout-grid-align: none"><SPAN style="FONT-FAMILY: 'Courier New'"><FONT size=1><SPAN style="mso-tab-count: 1"><FONT color=#000000>     </FONT></SPAN><SPAN style="COLOR: blue">Dim</SPAN><FONT color=#000000> dbName<SPAN style="mso-tab-count: 1">    </SPAN><SPAN style="mso-tab-count: 1">     </SPAN></FONT><SPAN style="COLOR: green">'The DNS name or IP address of your DB Server<o:p></o:p></SPAN></FONT></SPAN></P><P class=MsoNormal style="MARGIN: 0in 0in 0pt; mso-layout-grid-align: none"><SPAN style="FONT-FAMILY: 'Courier New'"><FONT size=1><SPAN style="mso-tab-count: 1"><FONT color=#000000>     </FONT></SPAN><SPAN style="COLOR: blue">Dim</SPAN><FONT color=#000000> UID<SPAN style="mso-tab-count: 1">   </SPAN><SPAN style="mso-tab-count: 2">          </SPAN></FONT><SPAN style="COLOR: green">'The User Name to login to your database<o:p></o:p></SPAN></FONT></SPAN></P><P class=MsoNormal style="MARGIN: 0in 0in 0pt; mso-layout-grid-align: none"><SPAN style="FONT-FAMILY: 'Courier New'"><FONT size=1><SPAN style="mso-tab-count: 1"><FONT color=#000000>     </FONT></SPAN><SPAN style="COLOR: blue">Dim</SPAN><FONT color=#000000> PWD<SPAN style="mso-tab-count: 1">   </SPAN><SPAN style="mso-tab-count: 2">          </SPAN></FONT><SPAN style="COLOR: green">'The Password to login to your database<o:p></o:p></SPAN></FONT></SPAN></P><P class=MsoNormal style="MARGIN: 0in 0in 0pt; mso-layout-grid-align: none"><SPAN style="FONT-FAMILY: 'Courier New'"><FONT size=1><SPAN style="mso-tab-count: 1"><FONT color=#000000>     </FONT></SPAN><SPAN style="COLOR: blue">Dim</SPAN><FONT color=#000000> Catalog<SPAN style="mso-tab-count: 1">   </SPAN><SPAN style="mso-tab-count: 1">     </SPAN></FONT><SPAN style="COLOR: green">'The specific database to connect to<o:p></o:p></SPAN></FONT></SPAN></P><P class=MsoNormal style="MARGIN: 0in 0in 0pt; mso-layout-grid-align: none"><SPAN style="FONT-FAMILY: 'Courier New'"><FONT size=1><SPAN style="mso-tab-count: 1"><FONT color=#000000>     </FONT></SPAN><SPAN style="COLOR: blue">Dim</SPAN><FONT color=#000000> TableName<SPAN style="mso-tab-count: 1"> </SPAN><SPAN style="mso-tab-count: 1">     </SPAN></FONT><SPAN style="COLOR: green">'The table we will retrieve data from<o:p></o:p></SPAN></FONT></SPAN></P><P class=MsoNormal style="MARGIN: 0in 0in 0pt; mso-layout-grid-align: none"><SPAN style="FONT-FAMILY: 'Courier New'"><FONT color=#000000><FONT size=1><SPAN style="mso-tab-count: 1">     </SPAN><o:p></o:p></FONT></FONT></SPAN></P><P class=MsoNormal style="MARGIN: 0in 0in 0pt; mso-layout-grid-align: none"><SPAN style="FONT-FAMILY: 'Courier New'"><FONT size=1><SPAN style="mso-tab-count: 1"><FONT color=#000000>     </FONT></SPAN><SPAN style="COLOR: green">'Setup Variable Values (CHANGE THIS TO HAVE THE INFORMATION FOR YOUR DATABASE)<o:p></o:p></SPAN></FONT></SPAN></P><P class=MsoNormal style="MARGIN: 0in 0in 0pt; mso-layout-grid-align: none"><SPAN style="FONT-FAMILY: 'Courier New'"><FONT size=1><SPAN style="mso-tab-count: 1"><FONT color=#000000>     </FONT></SPAN><SPAN style="COLOR: green">'*******************************************************<o:p></o:p></SPAN></FONT></SPAN></P><P class=MsoNormal style="MARGIN: 0in 0in 0pt; mso-layout-grid-align: none"><SPAN style="FONT-FAMILY: 'Courier New'"><FONT color=#000000><FONT size=1><SPAN style="mso-tab-count: 1">     </SPAN>dbName = "DBSERVER"<o:p></o:p></FONT></FONT></SPAN></P><P class=MsoNormal style="MARGIN: 0in 0in 0pt; mso-layout-grid-align: none"><SPAN style="FONT-FAMILY: 'Courier New'"><FONT color=#000000><FONT size=1><SPAN style="mso-tab-count: 1">     </SPAN>UID = "UID"<o:p></o:p></FONT></FONT></SPAN></P><P class=MsoNormal style="MARGIN: 0in 0in 0pt; mso-layout-grid-align: none"><SPAN style="FONT-FAMILY: 'Courier New'"><FONT color=#000000><FONT size=1><SPAN style="mso-tab-count: 1">     </SPAN>PWD = "PWD"<o:p></o:p></FONT></FONT></SPAN></P><P class=MsoNormal style="MARGIN: 0in 0in 0pt; mso-layout-grid-align: none"><SPAN style="FONT-FAMILY: 'Courier New'"><FONT color=#000000><FONT size=1><SPAN style="mso-tab-count: 1">     </SPAN>Catalog = "Northwind"<o:p></o:p></FONT></FONT></SPAN></P><P class=MsoNormal style="MARGIN: 0in 0in 0pt; mso-layout-grid-align: none"><SPAN style="FONT-FAMILY: 'Courier New'"><FONT color=#000000><FONT size=1><SPAN style="mso-tab-count: 1">     </SPAN>TableName = "Employees"<o:p></o:p></FONT></FONT></SPAN></P><P class=MsoNormal style="MARGIN: 0in 0in 0pt; mso-layout-grid-align: none"><SPAN style="FONT-FAMILY: 'Courier New'"><FONT color=#000000><FONT size=1><SPAN style="mso-tab-count: 1">     </SPAN><o:p></o:p></FONT></FONT></SPAN></P><P class=MsoNormal style="MARGIN: 0in 0in 0pt; mso-layout-grid-align: none"><SPAN style="FONT-FAMILY: 'Courier New'"><FONT size=1><SPAN style="mso-tab-count: 1"><FONT color=#000000>     </FONT></SPAN><SPAN style="COLOR: green">'Connect to the database<o:p></o:p></SPAN></FONT></SPAN></P><P class=MsoNormal style="MARGIN: 0in 0in 0pt; mso-layout-grid-align: none"><SPAN style="FONT-FAMILY: 'Courier New'"><FONT size=1><SPAN style="mso-tab-count: 1"><FONT color=#000000>     </FONT></SPAN><SPAN style="COLOR: green">'*******************************************************<o:p></o:p></SPAN></FONT></SPAN></P><P class=MsoNormal style="MARGIN: 0in 0in 0pt; mso-layout-grid-align: none"><SPAN style="FONT-FAMILY: 'Courier New'"><FONT color=#000000><FONT size=1><SPAN style="mso-tab-count: 1">     </SPAN>sConn = "Provider=SQLOLEDB;Data Source=" & dbName <o:p></o:p></FONT></FONT></SPAN></P><P class=MsoNormal style="MARGIN: 0in 0in 0pt; mso-layout-grid-align: none"><SPAN style="FONT-FAMILY: 'Courier New'"><FONT color=#000000><FONT size=1><SPAN style="mso-tab-count: 1">     </SPAN>sConn = sConn & ";Initial Catalog=" & Catalog & ";uid=" & UID & ";pwd=" & PWD<o:p></o:p></FONT></FONT></SPAN></P><P class=MsoNormal style="MARGIN: 0in 0in 0pt; mso-layout-grid-align: none"><SPAN style="FONT-FAMILY: 'Courier New'"><FONT size=1><SPAN style="mso-tab-count: 1"><FONT color=#000000>     </FONT></SPAN><SPAN style="COLOR: blue">Set</SPAN><FONT color=#000000> adoConn = CreateObject("ADODB.Connection")<SPAN style="mso-tab-count: 1">  </SPAN><o:p></o:p></FONT></FONT></SPAN></P><P class=MsoNormal style="MARGIN: 0in 0in 0pt; mso-layout-grid-align: none"><SPAN style="FONT-FAMILY: 'Courier New'"><FONT color=#000000><FONT size=1><SPAN style="mso-tab-count: 1">     </SPAN><o:p></o:p></FONT></FONT></SPAN></P><P class=MsoNormal style="MARGIN: 0in 0in 0pt; mso-layout-grid-align: none"><SPAN style="FONT-FAMILY: 'Courier New'"><FONT color=#000000><FONT size=1><SPAN style="mso-tab-count: 1">     </SPAN>adoConn.ConnectionString = sConn<o:p></o:p></FONT></FONT></SPAN></P><P class=MsoNormal style="MARGIN: 0in 0in 0pt; mso-layout-grid-align: none"><SPAN style="FONT-FAMILY: 'Courier New'"><FONT color=#000000><FONT size=1><SPAN style="mso-tab-count: 1">     </SPAN>adoConn.CursorLocation =<SPAN style="mso-spacerun: yes">  </SPAN>3<o:p></o:p></FONT></FONT></SPAN></P><P class=MsoNormal style="MARGIN: 0in 0in 0pt; mso-layout-grid-align: none"><SPAN style="FONT-FAMILY: 'Courier New'"><FONT color=#000000><FONT size=1><SPAN style="mso-tab-count: 1">     </SPAN><o:p></o:p></FONT></FONT></SPAN></P><P class=MsoNormal style="MARGIN: 0in 0in 0pt; mso-layout-grid-align: none"><SPAN style="FONT-FAMILY: 'Courier New'"><FONT color=#000000><FONT size=1><SPAN style="mso-tab-count: 1">     </SPAN>adoConn.Open<o:p></o:p></FONT></FONT></SPAN></P><P class=MsoNormal style="MARGIN: 0in 0in 0pt; mso-layout-grid-align: none"><SPAN style="FONT-FAMILY: 'Courier New'"><FONT color=#000000><FONT size=1><SPAN style="mso-tab-count: 1">     </SPAN><o:p></o:p></FONT></FONT></SPAN></P><P class=MsoNormal style="MARGIN: 0in 0in 0pt; mso-layout-grid-align: none"><SPAN style="FONT-FAMILY: 'Courier New'"><FONT size=1><SPAN style="mso-tab-count: 1"><FONT color=#000000>     </FONT></SPAN><SPAN style="COLOR: green">'Create the Command Object & Query<o:p></o:p></SPAN></FONT></SPAN></P><P class=MsoNormal style="MARGIN: 0in 0in 0pt; mso-layout-grid-align: none"><SPAN style="FONT-FAMILY: 'Courier New'"><FONT size=1><SPAN style="mso-tab-count: 1"><FONT color=#000000>     </FONT></SPAN><SPAN style="COLOR: green">'*******************************************************<o:p></o:p></SPAN></FONT></SPAN></P><P class=MsoNormal style="MARGIN: 0in 0in 0pt; mso-layout-grid-align: none"><SPAN style="FONT-FAMILY: 'Courier New'"><FONT size=1><SPAN style="mso-tab-count: 1"><FONT color=#000000>     </FONT></SPAN><SPAN style="COLOR: blue">Set</SPAN><FONT color=#000000> adoCmd = CreateObject("ADODB.Command")<SPAN style="mso-spacerun: yes">  </SPAN><o:p></o:p></FONT></FONT></SPAN></P><P class=MsoNormal style="MARGIN: 0in 0in 0pt; mso-layout-grid-align: none"><SPAN style="FONT-FAMILY: 'Courier New'"><FONT size=1><SPAN style="mso-tab-count: 1"><FONT color=#000000>     </FONT></SPAN><SPAN style="COLOR: blue">set</SPAN><FONT color=#000000> adoCmd.ActiveConnection = adoConn<SPAN style="mso-tab-count: 1"> </SPAN><o:p></o:p></FONT></FONT></SPAN></P><P class=MsoNormal style="MARGIN: 0in 0in 0pt; mso-layout-grid-align: none"><SPAN style="FONT-FAMILY: 'Courier New'"><FONT color=#000000><FONT size=1><SPAN style="mso-tab-count: 1">     </SPAN><o:p></o:p></FONT></FONT></SPAN></P><P class=MsoNormal style="MARGIN: 0in 0in 0pt; mso-layout-grid-align: none"><SPAN style="FONT-FAMILY: 'Courier New'"><FONT color=#000000><FONT size=1><SPAN style="mso-tab-count: 1">     </SPAN>sQuery = "SELECT * FROM " & UCase(TableName) & " FOR XML AUTO, ELEMENTS"<o:p></o:p></FONT></FONT></SPAN></P><P class=MsoNormal style="MARGIN: 0in 0in 0pt; mso-layout-grid-align: none"><SPAN style="FONT-FAMILY: 'Courier New'"><FONT color=#000000><FONT size=1><SPAN style="mso-tab-count: 1">     </SPAN><SPAN style="mso-tab-count: 1">     </SPAN><SPAN style="mso-tab-count: 1">     </SPAN><SPAN style="mso-spacerun: yes"> </SPAN><o:p></o:p></FONT></FONT></SPAN></P><P class=MsoNormal style="MARGIN: 0in 0in 0pt; mso-layout-grid-align: none"><SPAN style="FONT-FAMILY: 'Courier New'"><FONT color=#000000><FONT size=1><SPAN style="mso-tab-count: 1">     </SPAN>adoCmd.CommandText = sQuery<o:p></o:p></FONT></FONT></SPAN></P><P class=MsoNormal style="MARGIN: 0in 0in 0pt; mso-layout-grid-align: none"><SPAN style="FONT-FAMILY: 'Courier New'"><o:p><FONT color=#000000 size=1> </FONT></o:p></SPAN></P><P class=MsoNormal style="MARGIN: 0in 0in 0pt; mso-layout-grid-align: none"><SPAN style="FONT-FAMILY: 'Courier New'"><FONT size=1><SPAN style="mso-tab-count: 1"><FONT color=#000000>     </FONT></SPAN><SPAN style="COLOR: green">'Open the output stream and query the database<o:p></o:p></SPAN></FONT></SPAN></P><P class=MsoNormal style="MARGIN: 0in 0in 0pt; mso-layout-grid-align: none"><SPAN style="FONT-FAMILY: 'Courier New'"><FONT size=1><SPAN style="mso-tab-count: 1"><FONT color=#000000>     </FONT></SPAN><SPAN style="COLOR: green">'*******************************************************<o:p></o:p></SPAN></FONT></SPAN></P><P class=MsoNormal style="MARGIN: 0in 0in 0pt; mso-layout-grid-align: none"><SPAN style="FONT-FAMILY: 'Courier New'"><FONT size=1><SPAN style="mso-tab-count: 1"><FONT color=#000000>     </FONT></SPAN><SPAN style="COLOR: blue">Set</SPAN><FONT color=#000000> outStrm = CreateObject("ADODB.Stream")<SPAN style="COLOR: green"><o:p></o:p></SPAN></FONT></FONT></SPAN></P><P class=MsoNormal style="MARGIN: 0in 0in 0pt; mso-layout-grid-align: none"><SPAN style="FONT-FAMILY: 'Courier New'"><FONT color=#000000><FONT size=1><SPAN style="mso-tab-count: 1">     </SPAN>outStrm.Open<o:p></o:p></FONT></FONT></SPAN></P><P class=MsoNormal style="MARGIN: 0in 0in 0pt; mso-layout-grid-align: none"><SPAN style="FONT-FAMILY: 'Courier New'"><FONT color=#000000><FONT size=1><SPAN style="mso-tab-count: 1">     </SPAN>adoCmd.Properties("Output Stream") = outStrm<SPAN style="COLOR: green"><o:p></o:p></SPAN></FONT></FONT></SPAN></P><P class=MsoNormal style="MARGIN: 0in 0in 0pt; mso-layout-grid-align: none"><SPAN style="FONT-FAMILY: 'Courier New'"><FONT color=#000000><FONT size=1><SPAN style="mso-tab-count: 1">     </SPAN>adoCmd.Execute , , 1024 <SPAN style="COLOR: green"><o:p></o:p></SPAN></FONT></FONT></SPAN></P><P class=MsoNormal style="MARGIN: 0in 0in 0pt; mso-layout-grid-align: none"><SPAN style="COLOR: green; FONT-FAMILY: 'Courier New'"><o:p><FONT size=1> </FONT></o:p></SPAN></P><P class=MsoNormal style="MARGIN: 0in 0in 0pt; mso-layout-grid-align: none"><SPAN style="FONT-FAMILY: 'Courier New'"><FONT size=1><SPAN style="mso-tab-count: 1"><FONT color=#000000>     </FONT></SPAN><SPAN style="COLOR: green">'Set to the start of the stream, and then read all data.<o:p></o:p></SPAN></FONT></SPAN></P><P class=MsoNormal style="MARGIN: 0in 0in 0pt; mso-layout-grid-align: none"><SPAN style="FONT-FAMILY: 'Courier New'"><FONT size=1><SPAN style="mso-tab-count: 1"><FONT color=#000000>     </FONT></SPAN><SPAN style="COLOR: green">'*******************************************************<o:p></o:p></SPAN></FONT></SPAN></P><P class=MsoNormal style="MARGIN: 0in 0in 0pt; mso-layout-grid-align: none"><SPAN style="FONT-FAMILY: 'Courier New'"><FONT color=#000000><FONT size=1><SPAN style="mso-tab-count: 1">     </SPAN>outStrm.Position = 0<o:p></o:p></FONT></FONT></SPAN></P><P class=MsoNormal style="MARGIN: 0in 0in 0pt; mso-layout-grid-align: none"><SPAN style="FONT-FAMILY: 'Courier New'"><FONT color=#000000><FONT size=1><SPAN style="mso-tab-count: 1">     </SPAN>txtResults = outStrm.ReadText(-1)<o:p></o:p></FONT></FONT></SPAN></P><P class=MsoNormal style="MARGIN: 0in 0in 0pt; mso-layout-grid-align: none"><SPAN style="FONT-FAMILY: 'Courier New'"><FONT color=#000000><FONT size=1><SPAN style="mso-tab-count: 1">     </SPAN><o:p></o:p></FONT></FONT></SPAN></P><P class=MsoNormal style="MARGIN: 0in 0in 0pt; mso-layout-grid-align: none"><SPAN style="FONT-FAMILY: 'Courier New'"><FONT size=1><SPAN style="mso-tab-count: 1"><FONT color=#000000>     </FONT></SPAN><SPAN style="COLOR: green">'Cleanup Database objects<o:p></o:p></SPAN></FONT></SPAN></P><P class=MsoNormal style="MARGIN: 0in 0in 0pt; mso-layout-grid-align: none"><SPAN style="FONT-FAMILY: 'Courier New'"><FONT size=1><SPAN style="mso-tab-count: 1"><FONT color=#000000>     </FONT></SPAN><SPAN style="COLOR: green">'*******************************************************<o:p></o:p></SPAN></FONT></SPAN></P><P class=MsoNormal style="MARGIN: 0in 0in 0pt; mso-layout-grid-align: none"><SPAN style="FONT-FAMILY: 'Courier New'"><FONT color=#000000><FONT size=1><SPAN style="mso-tab-count: 1">     </SPAN>adoConn.Close<o:p></o:p></FONT></FONT></SPAN></P><P class=MsoNormal style="MARGIN: 0in 0in 0pt; mso-layout-grid-align: none"><SPAN style="FONT-FAMILY: 'Courier New'"><FONT size=1><SPAN style="mso-tab-count: 1"><FONT color=#000000>     </FONT></SPAN><SPAN style="COLOR: blue">set</SPAN><FONT color=#000000> adoConn = </FONT><SPAN style="COLOR: blue">Nothing<o:p></o:p></SPAN></FONT></SPAN></P><P class=MsoNormal style="MARGIN: 0in 0in 0pt; mso-layout-grid-align: none"><SPAN style="FONT-FAMILY: 'Courier New'"><FONT size=1><SPAN style="mso-tab-count: 1"><FONT color=#000000>     </FONT></SPAN><SPAN style="COLOR: blue">set</SPAN><FONT color=#000000> adoCmd = </FONT><SPAN style="COLOR: blue">Nothing<o:p></o:p></SPAN></FONT></SPAN></P><P class=MsoNormal style="MARGIN: 0in 0in 0pt; mso-layout-grid-align: none"><SPAN style="FONT-FAMILY: 'Courier New'"><FONT size=1><SPAN style="mso-tab-count: 1"><FONT color=#000000>     </FONT></SPAN><SPAN style="COLOR: blue">set</SPAN><FONT color=#000000> outStrm = </FONT><SPAN style="COLOR: blue">Nothing</SPAN><FONT color=#000000><SPAN style="mso-tab-count: 1">   </SPAN><o:p></o:p></FONT></FONT></SPAN></P><P class=MsoNormal style="MARGIN: 0in 0in 0pt; mso-layout-grid-align: none"><SPAN style="FONT-FAMILY: 'Courier New'"><FONT color=#000000><FONT size=1><SPAN style="mso-tab-count: 1">     </SPAN><o:p></o:p></FONT></FONT></SPAN></P><P class=MsoNormal style="MARGIN: 0in 0in 0pt; mso-layout-grid-align: none"><SPAN style="FONT-FAMILY: 'Courier New'"><FONT size=1><SPAN style="mso-tab-count: 1"><FONT color=#000000>     </FONT></SPAN><SPAN style="COLOR: green">'Output to a file<o:p></o:p></SPAN></FONT></SPAN></P><P class=MsoNormal style="MARGIN: 0in 0in 0pt; mso-layout-grid-align: none"><SPAN style="FONT-FAMILY: 'Courier New'"><FONT size=1><SPAN style="mso-tab-count: 1"><FONT color=#000000>     </FONT></SPAN><SPAN style="COLOR: green">'*******************************************************<o:p></o:p></SPAN></FONT></SPAN></P><P class=MsoNormal style="MARGIN: 0in 0in 0pt; mso-layout-grid-align: none"><SPAN style="FONT-FAMILY: 'Courier New'"><FONT size=1><SPAN style="mso-tab-count: 1"><FONT color=#000000>     </FONT></SPAN><SPAN style="COLOR: blue">set</SPAN><FONT color=#000000> fso = CreateObject("Scripting.FileSystemObject")<o:p></o:p></FONT></FONT></SPAN></P><P class=MsoNormal style="MARGIN: 0in 0in 0pt; mso-layout-grid-align: none"><SPAN style="FONT-FAMILY: 'Courier New'"><FONT color=#000000><FONT size=1><SPAN style="mso-tab-count: 1">     </SPAN><o:p></o:p></FONT></FONT></SPAN></P><P class=MsoNormal style="MARGIN: 0in 0in 0pt; mso-layout-grid-align: none"><SPAN style="FONT-FAMILY: 'Courier New'"><FONT size=1><SPAN style="mso-tab-count: 1"><FONT color=#000000>     </FONT></SPAN><SPAN style="COLOR: blue">set</SPAN><FONT color=#000000> ts = fso.CreateTextFile("OutputFile.xml")<o:p></o:p></FONT></FONT></SPAN></P><P class=MsoNormal style="MARGIN: 0in 0in 0pt; mso-layout-grid-align: none"><SPAN style="FONT-FAMILY: 'Courier New'"><FONT color=#000000><FONT size=1><SPAN style="mso-tab-count: 1">     </SPAN>ts.Write "<" & Ucase(TableName) & "Table>"<o:p></o:p></FONT></FONT></SPAN></P><P class=MsoNormal style="MARGIN: 0in 0in 0pt; TEXT-INDENT: 0.5in; mso-layout-grid-align: none"><SPAN style="FONT-FAMILY: 'Courier New'"><FONT color=#000000><FONT size=1>ts.Write txtResults <o:p></o:p></FONT></FONT></SPAN></P><P class=MsoNormal style="MARGIN: 0in 0in 0pt; TEXT-INDENT: 0.5in; mso-layout-grid-align: none"><SPAN style="FONT-FAMILY: 'Courier New'"><FONT color=#000000><FONT size=1>ts.Write "</" UCase(TableName) & ?Table></FONT></FONT></SPAN></P><P class=MsoNormal style="MARGIN: 0in 0in 0pt; mso-layout-grid-align: none"><SPAN style="FONT-FAMILY: 'Courier New'"><FONT color=#000000><FONT size=1><SPAN style="mso-tab-count: 1">     </SPAN>ts.Close<o:p></o:p></FONT></FONT></SPAN></P><P class=MsoNormal style="MARGIN: 0in 0in 0pt; mso-layout-grid-align: none"><SPAN style="FONT-FAMILY: 'Courier New'"><FONT color=#000000><FONT size=1><SPAN style="mso-tab-count: 1">     </SPAN><o:p></o:p></FONT></FONT></SPAN></P><P class=MsoNormal style="MARGIN: 0in 0in 0pt; mso-layout-grid-align: none"><SPAN style="FONT-FAMILY: 'Courier New'"><FONT size=1><SPAN style="mso-tab-count: 1"><FONT color=#000000>     </FONT></SPAN><SPAN style="COLOR: green">'Cleanup File write objects<o:p></o:p></SPAN></FONT></SPAN></P><P class=MsoNormal style="MARGIN: 0in 0in 0pt; mso-layout-grid-align: none"><SPAN style="FONT-FAMILY: 'Courier New'"><FONT size=1><SPAN style="mso-tab-count: 1"><FONT color=#000000>     </FONT></SPAN><SPAN style="COLOR: green">'*******************************************************<o:p></o:p></SPAN></FONT></SPAN></P><P class=MsoNormal style="MARGIN: 0in 0in 0pt; mso-layout-grid-align: none"><SPAN style="FONT-FAMILY: 'Courier New'"><FONT size=1><SPAN style="mso-tab-count: 1"><FONT color=#000000>     </FONT></SPAN><SPAN style="COLOR: blue">set</SPAN><FONT color=#000000> fso = </FONT><SPAN style="COLOR: blue">Nothing<o:p></o:p></SPAN></FONT></SPAN></P><P class=MsoNormal style="MARGIN: 0in 0in 0pt; mso-layout-grid-align: none"><SPAN style="FONT-FAMILY: 'Courier New'"><FONT size=1><SPAN style="mso-tab-count: 1"><FONT color=#000000>     </FONT></SPAN><SPAN style="COLOR: blue">set</SPAN><FONT color=#000000> ts = </FONT><SPAN style="COLOR: blue">Nothing</SPAN></FONT></SPAN></SPAN></P></SPAN></BLOGHELPER><FONT size=1>?></font></span></p><p></p></span>

          </p>
          <p>&nbsp;</p>
        </div>
      </article>
    </div>
  </div>
</div>

        
<!-- BEGIN #widgets -->
<section id="widgets" class="clearfix widgets">
  <div class="four large-4 columns">
    <h3>Flicker Photostream</h3>
    <!--  -->
    <div id="flickerPhotos" data-limit="6" data-random="true" data-userid="30005186@N02"></div>
  </div>
  <div class="four large-4 columns">
    <h3>Latest Blog Entries</h3>
    <div class="blog-entries">
      
      <article>
        <h5>
            <a href="/blog/new-project-hero-tracker/">
              New Project : Hero Tracker
            </a>
          </h5>
        <span>2004-11-24 00:00:00 -0600</span>
      </article>
      
      <article>
        <h5>
            <a href="/blog/getting-xml-from-a-sql-server-via-vbscript/">
              Getting XML from a SQL Server via VBScript
            </a>
          </h5>
        <span>2004-11-19 00:00:00 -0600</span>
      </article>
      
    </div>
  </div>
  <div class="four large-4 columns">
    <h3>About TimRayburn.net</h3>
    <p>
      Write an awesome description for your new site here. You can edit this line in _config.yml. It will appear in your document head meta (for Google search results) and in your feed.xml site description.
    </p>
  </div>
</section>
<!-- END /#widgets -->

<footer class="site-footer">
  <div class="copyright">
    &copy; 2014
    <a href="http://TimRayburn.net">Tim Rayburn</a>, All Rights Reserved.  </div>
  <a title="Scroll To Top" href="#top" id="scroll-top" class="scroll-top">
    <span>Top</span>
    <i class="icon-circleup"></i>
  </a>
</footer>

      </section>
    </section>
    <script type="text/javascript" src="/assets/js/jquery-1.10.2.min.js"></script>
<script type="text/javascript" src="/assets/js/jquery-migrate.js"></script>
<script type="text/javascript" src="/assets/js/plugins.js"></script>
<script type="text/javascript" src="/assets/js/headroom.js"></script>
<script type="text/javascript" src="/assets/js/jquery.unveilEffects.js"></script>
<script type="text/javascript" src="/assets/js/easyResponsiveTabs.js"></script>
<script type="text/javascript" src="/bower_components/foundation/js/foundation/foundation.js"></script>
<script type="text/javascript" src="/bower_components/foundation/js/foundation/foundation.equalizer.js"></script>
<script type="text/javascript" src="/assets/js/custom.js"></script>

  </body>
</html>
