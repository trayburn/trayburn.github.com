<!DOCTYPE html>
<html class="no-js" lang="en-US" data-cursor="ec008c">
  <head>

  <!-- Meta Tags -->
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <meta name="viewport" content="width=device-width">
  <meta name="description" content="Write an awesome description for your new site here. You can edit this line in _config.yml. It will appear in your document head meta (for Google search results) and in your feed.xml site description.">

  <title>TimRayburn.net - Split() Function for SQL Server 2000</title>

  <!-- Stylesheets -->
  <link rel="stylesheet" type="text/css" href="/style.css" media="all">

  <!-- Javascripts -->
  <script type="text/javascript" src="/assets/js/modernizr.js"></script>
  <script type="text/javascript" src="/assets/js/detection.js"></script>

</head>

  <body class="single-blog sticky-nav">
    <section class="container">
      <header id="masthead" class="site-header--fixed site-header" role="banner">
  <div class="row">

    <div id="logo" class="site-logo">

      <a href="index.html">
        <img src="/assets/images/site-logo.png" alt="This is the logo">
      </a>

    </div>

    
<div class="navbar">
  <nav class="site-navigation navigation">
    <ul id="primary" class="primary-menu">
      <li >
        <a href="/">Home</a>
      </li>
      
      <li >
        <a href="/consulting">Consulting</a>
      </li>
      
      <li >
        <a href="/community">Community</a>
      </li>
      
      <li >
        <a href="/creativity">Creativity</a>
      </li>
      
      <li >
        <a href="/contact">Contact</a>
      </li>
      
    </ul>

    <a href="#" class="nav-toggle icon-menu" aria-hidden="false"></a>
  </nav>
</div>

  </div>
</header>

      <div id="custom-header" class="site-background" data-image="dallas-skyline-1280-850.jpg" data-opacity="0.50" data-color="181a25">
  <div id="tagline" class="site-tagline row">
    <h1>
      Split() Function for SQL Server 2000
    </h1>
    <h2>
      
    </h2>
  </div>
</div>

      <section id="main" class="site-content row" role="main">
        <div class="blog--section-block clearfix">
  <div id="blog" class="blog-content">
    <div class="format format-image">
      <header class="page-header blog-title">
        <div class="post-meta">
          <p>
            Published at: <span class="publish-on">Mar 24, 2004</span>
          </p>
        </div>
      </header>
      
      <article>
        <div class="blog-subtitle">
          
          <p>
            <script type="text/javascript"><!--google_ad_client = "pub-3977329255226857";//Banner Ads - Hot Articlesgoogle_ad_slot = "8482486806";google_ad_width = 468;google_ad_height = 60;google_cpa_choice = ""; // on file//--></script><script type="text/javascript"src="http://pagead2.googlesyndication.com/pagead/show_ads.js"></script><P><FONT size=2>This function was originally found at the following address:</FONT></P><P><FONT size=2><A href="http://msdn.microsoft.com/library/en-us/dnsqlmag01/html/treatyourselfListing_01.txt">http://msdn.microsoft.com/library/en-us/dnsqlmag01/html/treatyourselfListing_01.txt</A></FONT></P><P><FONT size=2>But strikes me as so utterly useful that I'm archiving here as an article just so that I have a copy when next I find myself in a situation where I need it.</FONT></P><P><FONT size=2>CREATE FUNCTION fn_Split(@sText varchar(8000), @sDelim varchar(20) = ' ')<BR>RETURNS @retArray TABLE (idx smallint Primary Key, value varchar(8000))<BR>AS<BR>BEGIN<BR>DECLARE @idx smallint,<BR>@value varchar(8000),<BR>@bcontinue bit,<BR>@iStrike smallint,<BR>@iDelimlength tinyint<BR><BR>IF @sDelim = 'Space'<BR>BEGIN<BR>SET @sDelim = ' '<BR>END<BR><BR>SET @idx = 0<BR>SET @sText = LTrim(RTrim(@sText))<BR>SET @iDelimlength = DATALENGTH(@sDelim)<BR>SET @bcontinue = 1<BR><BR>IF NOT ((@iDelimlength = 0) or (@sDelim = 'Empty'))<BR>BEGIN<BR>WHILE @bcontinue = 1<BR>BEGIN<BR><BR>--If you can find the delimiter in the text, retrieve the first element and<BR>--insert it with its index into the return table.<BR><BR>IF CHARINDEX(@sDelim, @sText)&gt;0<BR>BEGIN<BR>SET @value = SUBSTRING(@sText,1, CHARINDEX(@sDelim,@sText)-1)<BR>BEGIN<BR>INSERT @retArray (idx, value)<BR>VALUES (@idx, @value)<BR>END<BR><BR>--Trim the element and its delimiter from the front of the string.<BR>--Increment the index and loop.<BR>SET @iStrike = DATALENGTH(@value) + @iDelimlength<BR>SET @idx = @idx + 1<BR>SET @sText = LTrim(Right(@sText,DATALENGTH(@sText) - @iStrike))<BR><BR>END<BR>ELSE<BR>BEGIN<BR>--If you canâ€™t find the delimiter in the text, @sText is the last value in<BR>--@retArray.<BR>SET @value = @sText<BR>BEGIN<BR>INSERT @retArray (idx, value)<BR>VALUES (@idx, @value)<BR>END<BR>--Exit the WHILE loop.<BR>SET @bcontinue = 0<BR>END<BR>END<BR>END<BR>ELSE<BR>BEGIN<BR>WHILE @bcontinue=1<BR>BEGIN<BR>--If the delimiter is an empty string, check for remaining text<BR>--instead of a delimiter. Insert the first character into the<BR>--retArray table. Trim the character from the front of the string.<BR>--Increment the index and loop.<BR>IF DATALENGTH(@sText)&gt;1<BR>BEGIN<BR>SET @value = SUBSTRING(@sText,1,1)<BR>BEGIN<BR>INSERT @retArray (idx, value)<BR>VALUES (@idx, @value)<BR>END<BR>SET @idx = @idx+1<BR>SET @sText = SUBSTRING(@sText,2,DATALENGTH(@sText)-1)<BR><BR>END<BR>ELSE<BR>BEGIN<BR>--One character remains.<BR>--Insert the character, and exit the WHILE loop.<BR>INSERT @retArray (idx, value)<BR>VALUES (@idx, @sText)<BR>SET @bcontinue = 0 <BR>END<BR>END<BR><BR>END<BR><BR>RETURN<BR>END</FONT><BR><BR></P>

          </p>
          <p>&nbsp;</p>
        </div>
      </article>
    </div>
  </div>
</div>

        
<!-- BEGIN #widgets -->
<section id="widgets" class="clearfix widgets">
  <div class="four large-4 columns">
    <h3>Flicker Photostream</h3>
    <!--  -->
    <div id="flickerPhotos" data-limit="6" data-random="true" data-userid="30005186@N02"></div>
  </div>
  <div class="four large-4 columns">
    <h3>Latest Blog Entries</h3>
    <div class="blog-entries">
      
      <article>
        <h5>
            <a href="/blog/new-project-hero-tracker/">
              New Project : Hero Tracker
            </a>
          </h5>
        <span>2004-11-24 00:00:00 -0600</span>
      </article>
      
      <article>
        <h5>
            <a href="/blog/getting-xml-from-a-sql-server-via-vbscript/">
              Getting XML from a SQL Server via VBScript
            </a>
          </h5>
        <span>2004-11-19 00:00:00 -0600</span>
      </article>
      
    </div>
  </div>
  <div class="four large-4 columns">
    <h3>About TimRayburn.net</h3>
    <p>
      Write an awesome description for your new site here. You can edit this line in _config.yml. It will appear in your document head meta (for Google search results) and in your feed.xml site description.
    </p>
  </div>
</section>
<!-- END /#widgets -->

<footer class="site-footer">
  <div class="copyright">
    &copy; 2014
    <a href="http://TimRayburn.net">Tim Rayburn</a>, All Rights Reserved.  </div>
  <a title="Scroll To Top" href="#top" id="scroll-top" class="scroll-top">
    <span>Top</span>
    <i class="icon-circleup"></i>
  </a>
</footer>

      </section>
    </section>
    <script type="text/javascript" src="/assets/js/jquery-1.10.2.min.js"></script>
<script type="text/javascript" src="/assets/js/jquery-migrate.js"></script>
<script type="text/javascript" src="/assets/js/plugins.js"></script>
<script type="text/javascript" src="/assets/js/headroom.js"></script>
<script type="text/javascript" src="/assets/js/jquery.unveilEffects.js"></script>
<script type="text/javascript" src="/assets/js/easyResponsiveTabs.js"></script>
<script type="text/javascript" src="/bower_components/foundation/js/foundation/foundation.js"></script>
<script type="text/javascript" src="/bower_components/foundation/js/foundation/foundation.equalizer.js"></script>
<script type="text/javascript" src="/assets/js/custom.js"></script>

  </body>
</html>
